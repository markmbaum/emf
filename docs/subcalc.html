
    <html lang="en">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <title>subcalc</title>
            <link href="https://fonts.googleapis.com/css?family=Anonymous+Pro|Open+Sans" rel="stylesheet">
            <style>body {
    color: #ABB2BF;
    background-color: #282C34;
    font-family: 'Anonymous Pro', monospace;
    margin: 0;
    padding: 0;
    overflow: scroll;
}

#back-to-top {
    position: fixed;
    right: 0;
    bottom: 0;
    padding: 3px;
    margin: 0;
    background-color: inherit;
    color: #828997;
    font-family: "Open Sans", sans-serif;
    font-size: 11pt;
    text-decoration: none;
    border-top: 1px solid #505050;
    border-left: 1px solid #505050;
}

#mod-docstr {
    margin: 0;
    text-align: justify;
    line-height: 150%;
    color: #ABB2BF;
    font-family: "Open Sans", sans-serif;
    font-size: 11pt;
}

.monospace-span {
    font-family: 'Anonymous Pro', monospace;
    font-size: 125%;
}

#nav-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0 5px 0 0;
    min-height: 1vh;
    background-color: #20242C;
}

#nav {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    overflow-y: scroll;
    padding: 0.5cm;
    min-height: 1vh;
    background-color: inherit;
    border-right: 1px solid #505050;
}

#nav::-webkit-scrollbar {
    width: 4px;
}

#nav h2 {
    font-family: "Open Sans", sans-serif;
    font-weight: normal;
    font-size: 24pt;
    margin: 0.25cm 0;
}

#nav-ul {
    margin: 0;
    padding: 0;
    list-style-type: none;
}

.nav-li {
    font-family: "Open Sans", sans-serif;
    font-size: 18pt;
    margin: 0.5cm 0;
}

.nav-li a {
    text-decoration: none;
    color: #828997;
}

.subnav-ul {
    list-style-type: none;
    padding: 0 0 0 0.5cm;
    margin: 0.5cm 0;
}

.subnav-li {
    font-family: "Anonymous Pro", monospace;
    font-size: 13pt;
    margin: 0.15cm 0;
}

.subnav-li a {
    text-decoration: none;
    color: #828997;
}

.subsubnav-ul {
    list-style-type: none;
    padding: 0 0 0 0.5cm;
    margin: 0.4cm 0;
}

.subsubnav-li {
    font-family: "Open Sans", sans-serif;
    font-size: 11pt;
    margin: 0.15cm 0;
}

.subsubnav-li a {
    text-decoration: none;
    color: #828997;
}

.subsubsubnav-ul {
    list-style-type: none;
    padding: 0 0 0 0.5cm;
    margin: 0.3cm 0;
}

.subsubsubnav-li {
    font-family: "Anonymous Pro", monospace;
    font-size: 11pt;
    margin: 0.15cm 0;
}

.subsubsubnav-li a {
    text-decoration: none;
    color: #828997;
}

#nav a:hover {
    font-weight: 700;
    color: #ABB2BF;
}

#main {
    float: right;
    z-index: -1;
}

#main h1 {
    font-family: "Open Sans", sans-serif;
    font-weight: normal;
    font-size: 400%;
    text-align: center;
    margin: 1cm 0;
}

.section {
    margin: 1cm;
    padding: 5% 5% 5% 1cm;
    border: 1px solid #484848;
    border-radius: 12px;
}

.section h2 {
    font-weight: normal;
    font-size: 250%;
    font-family: "Open Sans", sans-serif;
    text-align: center;
    margin: 0 0 1cm 0;
}

.docstr {
    margin: .5cm 0 .5cm 1cm;
    font-size: 90%;
    text-align: justify;
    line-height: 125%;
    color: #98C379;
}

.docstr pre {
    margin: 0;
    padding: 0;
    font-size: inherit;
}

.class {
    border-top: 1px solid #404040;
}

.class h3 {
    font-weight: normal;
    font-size: 200%;
    font-family: "Open Sans", sans-serif;
    padding: 0;
    margin: 1cm 0 0 0.5cm;
}

#classes .class {
    margin-top: 1cm;
}

.class .function {
    padding-left: 0.1cm;
    border-left: 1px solid #404040;
}

.properties {
    margin: 1cm 0;
    padding-left: 0.1cm;
    border-left: 1px solid #404040;
}

.properties h4 {
    font-weight: normal;
    font-family: "Open Sans", sans-serif;
    font-size: 150%;
}

.properties .property {
    margin-left: 1cm;
    padding-left: 0.1cm;
    border-left: 1px solid #383838;
}

.methods {
    margin: 1cm 0 0 0;
    padding-left: 0.1cm;
    border-left: 1px solid #404040;
}

.methods h4 {
  font-weight: normal;
  font-family: "Open Sans", sans-serif;
  font-size: 150%;
}

.methods .function {
    margin-left: 1cm;
    border-left: 1px solid #383838;
}

#functions .function {
    border-top: 1px solid #404040;
}

.function .function-name {
    color: #61AFEF;
}

.function .function-arg {
    color: #D19A66;
}

.function .default-str {
    color: #98C379;
}

.source {
    display: inline-block;
    margin: .5cm 0 .5cm 1cm;
    border: 1px solid #383838;
    border-radius: 12px;
}

.source h4 {
    font-family: "Open Sans", sans-serif;
    font-weight: 400;
    font-size: 10pt;
    margin: 0;
    padding: 0.25cm;
    cursor: pointer;
}

.source .code {
    display: none;
    overflow: auto;
    padding: 0 0.5cm 0.5cm 0.5cm;
    font-size: 10pt;
}

.other {
    margin: 0.5cm 0;
}

.other-type {
    margin: .1cm .1cm .1cm 0;
    color: #5C6370;
}

.other-value {
    margin: .1cm .1cm .1cm 0;
    color: #5C6370;
}

.other .comments {
    margin: 0;
    padding: 0.5cm 0 0.5 1cm;
}

.other pre {
    margin: 0;
    padding: 0 0 0 1.5cm;
}
.highlight .k  {color: #C678DD;}

.highlight .nf {color: #61AFEF;}
.highlight .nf .n {color: #D19A66;}
.highlight .nb {color: #56B6C2;}

.highlight .o  {font-weight: bold;}
.highlight .ow {color: #C678DD;}

.highlight .s1 {color: #98C379;}
.highlight .s2 {color: #98C379;}
.highlight .sd {color: #98C379;}
.highlight .si {color: #D19A66;}

.highlight .mi {color: #D19A66;}
.highlight .mf {color: #D19A66;}
.highlight .mh {color: #D19A66;}
.highlight .mo {color: #D19A66;}

.highlight .bp {color: #D19A66;}
.highlight .bp2 {color: #E06C75;}


.highlight .c1 {color: #5C6370;}
</style>
            <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67200904-4', 'auto');
  ga('send', 'pageview');

</script>

            <!--Control the width and height of the #main element-->
            <script type="text/javascript">
function arrange(){
    var nav_wrapper = document.getElementById('nav-wrapper');
    var nav = document.getElementById('nav');
    var main = document.getElementById('main');
    var body = document.body;

    var w_nav = nav.offsetWidth + 1;
    var m = w_nav.toString() + 'px';
    var w = (body.offsetWidth - w_nav).toString() + 'px';

    main.setAttribute('style', 'margin-left: ' + m);
    main.style.marginLeft = m;

    main.setAttribute('style', 'width: ' + w);
    main.style.width = w;

    console.log('arrange')

};

function toggleSource(obj){
    var parent = obj.parentElement;
    var children = parent.children;

    var header = children[0];
    var code = children[1];
    var codeDisplay = code.style.display;

    if(codeDisplay == 'block'){
        code.style.display = 'none';
        header.innerHTML = 'show source';
        parent.style.borderColor = '#383838'
    }else{
        code.style.display = 'block';
        header.innerHTML = 'hide source';
        parent.style.borderColor = '#C678DD'
    };

    arrange();
};
</script>
    	</head>
        <body onresize="arrange()" onload="arrange()">

            <!--Back to Top Button-->
            <a id="back-to-top" href="#">back to top</a>

            <!--Navigation Sidebar-->
            <div id="nav-wrapper">
                <div id="nav">
                    <h2>contents</h2>
                    <ul id="nav-ul">
            <li class="nav-li"><a href="#functions">functions</a>
                <ul class="subnav-ul"><li class="subnav-li"><a href="#B_field_segment">B_field_segment</a></li></li><li class="subnav-li"><a href="#close">close</a></li></li><li class="subnav-li"><a href="#convert_INP">convert_INP</a></li></li><li class="subnav-li"><a href="#convert_REF">convert_REF</a></li></li><li class="subnav-li"><a href="#cumulative_distance">cumulative_distance</a></li></li><li class="subnav-li"><a href="#drop_footprint_template">drop_footprint_template</a></li></li><li class="subnav-li"><a href="#drop_tower_template">drop_tower_template</a></li></li><li class="subnav-li"><a href="#grid_segment_results">grid_segment_results</a></li></li><li class="subnav-li"><a href="#ion">ion</a></li></li><li class="subnav-li"><a href="#load_results">load_results</a></li></li><li class="subnav-li"><a href="#load_towers">load_towers</a></li></li><li class="subnav-li"><a href="#mesh_dict_grids">mesh_dict_grids</a></li></li><li class="subnav-li"><a href="#phasors_to_magnitudes">phasors_to_magnitudes</a></li></li><li class="subnav-li"><a href="#plot_contour">plot_contour</a></li></li><li class="subnav-li"><a href="#plot_cross_sections">plot_cross_sections</a></li></li><li class="subnav-li"><a href="#plot_path">plot_path</a></li></li><li class="subnav-li"><a href="#plot_pcolormesh">plot_pcolormesh</a></li></li><li class="subnav-li"><a href="#plot_wires_3D">plot_wires_3D</a></li></li><li class="subnav-li"><a href="#read_INP">read_INP</a></li></li><li class="subnav-li"><a href="#read_REF">read_REF</a></li></li><li class="subnav-li"><a href="#show">show</a></li></li></ul>
            <li class="nav-li"><a href="#classes">classes</a>
                <ul class="subnav-ul"><li class="subnav-li"><a href="#Conductor">Conductor</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#Conductor-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Conductor-I>I</a></li><li class="subsubsubnav-li"><a href=#Conductor-name>name</a></li><li class="subsubsubnav-li"><a href=#Conductor-phase>phase</a></li><li class="subsubsubnav-li"><a href=#Conductor-x>x</a></li><li class="subsubsubnav-li"><a href=#Conductor-y>y</a></li><li class="subsubsubnav-li"><a href=#Conductor-z>z</a></li></ul></li></ul></li><li class="subnav-li"><a href="#Footprint">Footprint</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#Footprint-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Footprint-draw_as_loop>draw_as_loop</a></li><li class="subsubsubnav-li"><a href=#Footprint-group>group</a></li><li class="subsubsubnav-li"><a href=#Footprint-name>name</a></li><li class="subsubsubnav-li"><a href=#Footprint-of_concern>of_concern</a></li><li class="subsubsubnav-li"><a href=#Footprint-power_line>power_line</a></li><li class="subsubsubnav-li"><a href=#Footprint-x>x</a></li><li class="subsubsubnav-li"><a href=#Footprint-y>y</a></li></ul></li></ul></li><li class="subnav-li"><a href="#Model">Model</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#Model-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Model-N>N</a></li><li class="subsubsubnav-li"><a href=#Model-X>X</a></li><li class="subsubsubnav-li"><a href=#Model-Y>Y</a></li><li class="subsubsubnav-li"><a href=#Model-auto_lim_frac>auto_lim_frac</a></li><li class="subsubsubnav-li"><a href=#Model-conductors>conductors</a></li><li class="subsubsubnav-li"><a href=#Model-footprints>footprints</a></li><li class="subsubsubnav-li"><a href=#Model-name>name</a></li><li class="subsubsubnav-li"><a href=#Model-segments>segments</a></li><li class="subsubsubnav-li"><a href=#Model-spacing>spacing</a></li><li class="subsubsubnav-li"><a href=#Model-tower_group_names>tower_group_names</a></li><li class="subsubsubnav-li"><a href=#Model-tower_groups>tower_groups</a></li><li class="subsubsubnav-li"><a href=#Model-towers>towers</a></li><li class="subsubsubnav-li"><a href=#Model-x>x</a></li><li class="subsubsubnav-li"><a href=#Model-xlim>xlim</a></li><li class="subsubsubnav-li"><a href=#Model-xmax>xmax</a></li><li class="subsubsubnav-li"><a href=#Model-xmin>xmin</a></li><li class="subsubsubnav-li"><a href=#Model-y>y</a></li><li class="subsubsubnav-li"><a href=#Model-ylim>ylim</a></li><li class="subsubsubnav-li"><a href=#Model-ymax>ymax</a></li><li class="subsubsubnav-li"><a href=#Model-ymin>ymin</a></li><li class="subsubsubnav-li"><a href=#Model-z>z</a></li></ul></li><li class="subsubnav-li"><a href=#Model-methods>methods</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Model-add_conductor>add_conductor</a></li><li class="subsubsubnav-li"><a href=#Model-add_tower>add_tower</a></li><li class="subsubsubnav-li"><a href=#Model-calculate>calculate</a></li><li class="subsubsubnav-li"><a href=#Model-clear_towers>clear_towers</a></li><li class="subsubsubnav-li"><a href=#Model-load_towers>load_towers</a></li><li class="subsubsubnav-li"><a href=#Model-sample>sample</a></li><li class="subsubsubnav-li"><a href=#Model-to_tower_template>to_tower_template</a></li></ul></li></ul></li><li class="subnav-li"><a href="#Results">Results</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#Results-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Results-B>B</a></li><li class="subsubsubnav-li"><a href=#Results-Bkey>Bkey</a></li><li class="subsubsubnav-li"><a href=#Results-Bkeys>Bkeys</a></li><li class="subsubsubnav-li"><a href=#Results-Bmax>Bmax</a></li><li class="subsubsubnav-li"><a href=#Results-Bmin>Bmin</a></li><li class="subsubsubnav-li"><a href=#Results-N>N</a></li><li class="subsubsubnav-li"><a href=#Results-X>X</a></li><li class="subsubsubnav-li"><a href=#Results-Y>Y</a></li><li class="subsubsubnav-li"><a href=#Results-footprint_df>footprint_df</a></li><li class="subsubsubnav-li"><a href=#Results-footprint_group_names>footprint_group_names</a></li><li class="subsubsubnav-li"><a href=#Results-footprint_groups>footprint_groups</a></li><li class="subsubsubnav-li"><a href=#Results-footprints>footprints</a></li><li class="subsubsubnav-li"><a href=#Results-idx_Bmax>idx_Bmax</a></li><li class="subsubsubnav-li"><a href=#Results-info>info</a></li><li class="subsubsubnav-li"><a href=#Results-loc_Bmax>loc_Bmax</a></li><li class="subsubsubnav-li"><a href=#Results-name>name</a></li><li class="subsubsubnav-li"><a href=#Results-north_angle>north_angle</a></li><li class="subsubsubnav-li"><a href=#Results-spacing>spacing</a></li><li class="subsubsubnav-li"><a href=#Results-x>x</a></li><li class="subsubsubnav-li"><a href=#Results-xlim>xlim</a></li><li class="subsubsubnav-li"><a href=#Results-xmax>xmax</a></li><li class="subsubsubnav-li"><a href=#Results-xmin>xmin</a></li><li class="subsubsubnav-li"><a href=#Results-y>y</a></li><li class="subsubsubnav-li"><a href=#Results-ylim>ylim</a></li><li class="subsubsubnav-li"><a href=#Results-ymax>ymax</a></li><li class="subsubsubnav-li"><a href=#Results-ymin>ymin</a></li></ul></li><li class="subsubnav-li"><a href=#Results-methods>methods</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Results-concern_points>concern_points</a></li><li class="subsubsubnav-li"><a href=#Results-copy>copy</a></li><li class="subsubsubnav-li"><a href=#Results-export>export</a></li><li class="subsubsubnav-li"><a href=#Results-flatten>flatten</a></li><li class="subsubsubnav-li"><a href=#Results-in_grid>in_grid</a></li><li class="subsubsubnav-li"><a href=#Results-interp>interp</a></li><li class="subsubsubnav-li"><a href=#Results-load_footprints>load_footprints</a></li><li class="subsubsubnav-li"><a href=#Results-path>path</a></li><li class="subsubsubnav-li"><a href=#Results-rereference>rereference</a></li><li class="subsubsubnav-li"><a href=#Results-resample>resample</a></li><li class="subsubsubnav-li"><a href=#Results-segment>segment</a></li><li class="subsubsubnav-li"><a href=#Results-zoom>zoom</a></li></ul></li></ul></li><li class="subnav-li"><a href="#Tower">Tower</a><ul class="subsubnav-ul"><li class="subsubnav-li"><a href=#Tower-properties>properties</a><ul class="subsubsubnav-ul"><li class="subsubsubnav-li"><a href=#Tower-I>I</a></li><li class="subsubsubnav-li"><a href=#Tower-conductor_x>conductor_x</a></li><li class="subsubsubnav-li"><a href=#Tower-conductor_y>conductor_y</a></li><li class="subsubsubnav-li"><a href=#Tower-conductor_z>conductor_z</a></li><li class="subsubsubnav-li"><a href=#Tower-group>group</a></li><li class="subsubsubnav-li"><a href=#Tower-h>h</a></li><li class="subsubsubnav-li"><a href=#Tower-phase>phase</a></li><li class="subsubsubnav-li"><a href=#Tower-rot>rot</a></li><li class="subsubsubnav-li"><a href=#Tower-rot_rad>rot_rad</a></li><li class="subsubsubnav-li"><a href=#Tower-seq>seq</a></li><li class="subsubsubnav-li"><a href=#Tower-tower_x>tower_x</a></li><li class="subsubsubnav-li"><a href=#Tower-tower_y>tower_y</a></li><li class="subsubsubnav-li"><a href=#Tower-v>v</a></li></ul></li></ul></li></ul>
            <li class="nav-li"><a href="#others">others</a>
                <ul class="subnav-ul"><li class="subnav-li"><a href="#be_concerned">be_concerned</a></li></li></ul></ul></div></div>

            <div id="main">
                <h1>subcalc</h1>
                <!--module docstring section-->
                <div class="section"><p id="mod-docstr">Like emf.fields, emf.subcalc was originally intended to supplement/extend the use of another modeling program. In this case, the other modeling program is SUBCALC (developed by Enertech, sponsored by EPRI). SUBCALC predicts magnetic fields over a fixed-height 2 dimensional grid and can model many non-parallel segments of power lines. It is generally used to model magnetic fields near electrical substations, where circuit arrangements can be complex. Just like emf.fields, emf.subcalc is now a complete replacement of the program it was originally intended to supplement. Although it provides no fancy UI, emf.subcalc is capable of calculating the magnetic fields produced by complex, three dimensional arrangements of current carrying wire segments.<br><br>While the emf.subcalc package is capable of calculating the magnetic fields generated by complex, three dimensional arrangements of current carrying wire segments, it is not capable of calculating fields generated by other electrical equiment like buses, circuit breakers, power transformers, air core reactors, and capacitor banks. The SUBCALC program, which emf.subcalc emulates and interfaces with, is capable of modeling that equipment. The SUBCALC program also provides a UI enabling a user to draw towers onto a map view of a model domain and edit the wire configurations of each tower. The UI is generally helpful for creating small models, but it can be frustrating when creating more complicated models and when creating slightly different versions of the same model. emf.subcalc provides no UI and would certainly be harder to learn, but it can perform the calculations that most modeling scenarios require and it provides better analysis and plotting methods than SUBCALC.<br><br>Importantly though, the old SUBCALC program is not free. It's not terribly expensive either, but one must navigate an annoying web of contacts and phone numbers to get an annually renewed license. In many tests, emf.subcalc has produced the exact same results as SUBCALC for the same inputs.</p></div>

                <!--functions section-->
                <div class="section" id="functions"><h2>functions</h2><div class="function" id="B_field_segment"><p class="function-str"><span class="function-name">B_field_segment</span>(<span class="function-arg">a</span>, <span class="function-arg">b</span>, <span class="function-arg">I</span>, <span class="function-arg">ph</span>, <span class="function-arg">x</span>, <span class="function-arg">y</span>, <span class="function-arg">z</span>)</p><p class="docstr">Calculate the magnetic field generated by a current carrying wire segment at an arbitrary set of points in 3 dimensions<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;a - 1D numpy array containing the x,y,z coordinates of the beginning<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of the wire segment (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;b - 1D numpy array containing the x,y,z coordinates of the end<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of the wire segment (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;I - float, the current of the wire segment (Amps)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ph - float, the phase of the current (degrees)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - 1D numpy array, x coordinates of the sample points (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - 1D numpy array, y coordinates of the sample points (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;z - 1D numpy array, z coordinates of the sample points (ft)<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_x - 1D numpy array of complex numbers, magnetic field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   the x direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_y - 1D numpy array of complex numbers, magnetic field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   the y direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_z - 1D numpy array of complex numbers, magnetic field phasors in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   the z direction</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">B_field_segment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the magnetic field generated by a current carrying wire segment
    at an arbitrary set of points in 3 dimensions
    args:</span>
<span class="sd">        a - 1D numpy array containing the x,y,z coordinates of the beginning</span>
<span class="sd">            of the wire segment (ft)</span>
<span class="sd">        b - 1D numpy array containing the x,y,z coordinates of the end</span>
<span class="sd">            of the wire segment (ft)</span>
<span class="sd">        I - float, the current of the wire segment (Amps)</span>
<span class="sd">        ph - float, the phase of the current (degrees)</span>
<span class="sd">        x - 1D numpy array, x coordinates of the sample points (ft)</span>
<span class="sd">        y - 1D numpy array, y coordinates of the sample points (ft)</span>
<span class="sd">        z - 1D numpy array, z coordinates of the sample points (ft)</span>
<span class="sd">    returns:</span>
<span class="sd">        Ph_x - 1D numpy array of complex numbers, magnetic field phasors in</span>
<span class="sd">               the x direction</span>
<span class="sd">        Ph_y - 1D numpy array of complex numbers, magnetic field phasors in</span>
<span class="sd">               the y direction</span>
<span class="sd">        Ph_z - 1D numpy array of complex numbers, magnetic field phasors in</span>
<span class="sd">               the z direction&quot;&quot;&quot;</span>

    <span class="c1">#conversions</span>
    <span class="n">a</span>  <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="mf">0.3048</span>       <span class="c1">#convert to meters</span>
    <span class="n">b</span>  <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="mf">0.3048</span>       <span class="c1">#convert to meters</span>
    <span class="n">x</span>  <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="mf">0.3048</span>       <span class="c1">#convert to meters</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="mf">0.3048</span>       <span class="c1">#convert to meters</span>
    <span class="n">z</span>  <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="mf">0.3048</span>       <span class="c1">#convert to meters</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="n">ph</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">360</span> <span class="c1">#convert to radians</span>

    <span class="c1">#pull out the coordinates of the starting and ending point of the wire</span>
    <span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="n">za</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">zb</span> <span class="o">=</span> <span class="n">b</span>

    <span class="c1">#store the differences bewteen each dimension&#39;s coordinates</span>
    <span class="n">delta_x</span> <span class="o">=</span> <span class="n">xb</span> <span class="o">-</span> <span class="n">xa</span>
    <span class="n">delta_y</span> <span class="o">=</span> <span class="n">yb</span> <span class="o">-</span> <span class="n">ya</span>
    <span class="n">delta_z</span> <span class="o">=</span> <span class="n">zb</span> <span class="o">-</span> <span class="n">za</span>

    <span class="c1">#convert the current and phase into a complex phasor</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span> <span class="o">+</span> <span class="nb">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">))</span>

    <span class="c1">#calculate fac_x, fac_y, fac_z, and integral with the C extension or the</span>
    <span class="c1">#backup Python module</span>
    <span class="k">if</span><span class="p">(</span><span class="n">_lift_loaded</span><span class="p">):</span>

        <span class="c1">#use the functions in lift.c to do the heavy computational lifting of</span>
        <span class="c1">#these calculations, which are mostly made heavy by the path integral</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#variables to be filled in by lift.lift</span>
        <span class="n">fac_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
        <span class="n">fac_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
        <span class="n">fac_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>
        <span class="c1">#variable of convenience</span>
        <span class="n">c_double_ptr</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">)</span>
        <span class="c1">#call the calculations, converting everything to its C type</span>
        <span class="n">lift</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">),</span>
                <span class="n">y</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">),</span>
                <span class="n">z</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">delta_x</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">delta_y</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">delta_z</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">ya</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">za</span><span class="p">),</span>
                <span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
                <span class="n">fac_x</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">),</span>
                <span class="n">fac_y</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">),</span>
                <span class="n">fac_z</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">),</span>
                <span class="n">integral</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">c_double_ptr</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">fac_x</span><span class="p">,</span> <span class="n">fac_y</span><span class="p">,</span> <span class="n">fac_z</span><span class="p">,</span> <span class="n">integral</span> <span class="o">=</span> <span class="n">lift</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>
                <span class="n">delta_x</span><span class="p">,</span> <span class="n">delta_y</span><span class="p">,</span> <span class="n">delta_z</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="n">za</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="c1">#print fac_x</span>

    <span class="c1">#carry through with the rest of the calculations</span>
    <span class="n">con</span>  <span class="o">=</span> <span class="n">magnetic_prefactor</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">integral</span>
    <span class="n">Ph_x</span> <span class="o">=</span> <span class="n">fac_x</span><span class="o">*</span><span class="n">con</span>
    <span class="n">Ph_y</span> <span class="o">=</span> <span class="n">fac_y</span><span class="o">*</span><span class="n">con</span>
    <span class="n">Ph_z</span> <span class="o">=</span> <span class="n">fac_z</span><span class="o">*</span><span class="n">con</span>

    <span class="k">return</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span> <span class="n">Ph_y</span><span class="p">,</span> <span class="n">Ph_z</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="close"><p class="function-str"><span class="function-name">close</span>(*<span class="function-arg">args</span>)</p><p class="docstr">Call plt.close() on any Figure objects or lists of Figure objects passed in. If nothing is passed, all Figure objects are closed with plt.close('all')</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call plt.close() on any Figure objects or lists of Figure objects passed
    in. If nothing is passed, all Figure objects are closed with
    plt.close(&#39;all&#39;)&quot;&quot;&quot;</span><span class="n">
</span>    <span class="k">if</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="convert_INP"><p class="function-str"><span class="function-name">convert_INP</span>(<span class="function-arg">file_path</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Convert a formatted SUBCALC file containing model input information in to an emf.subcalc tower template file. The target file must have an INP extension. These files are generated by the "Output > Ascii > Input Data" function in the SUBCALC program.<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;file_path - string, path to the target INP file<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, output destination/filename</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_INP</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a formatted SUBCALC file containing model input information in to
    an emf.subcalc tower template file. The target file must have an INP
    extension. These files are generated by the &quot;Output &gt; Ascii &gt; Input Data&quot;
    function in the SUBCALC program.
    args:</span>
<span class="sd">        file_path - string, path to the target INP file</span>
<span class="sd">    kw:</span>
<span class="sd">        path - string, output destination/filename&quot;&quot;&quot;</span>

    <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">load_towers</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_tower_template</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="convert_REF"><p class="function-str"><span class="function-name">convert_REF</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Convert a .REF results file to an excel file storing the same data and save the excel file<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;REF_path - string, path to the .REF file<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;footprint_path - string, optional, path to footprint csv file<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, path/name of output file</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_REF</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a .REF results file to an excel file storing the same data and save the excel file</span>
<span class="sd">    args:</span>
<span class="sd">        REF_path - string, path to the .REF file</span>
<span class="sd">        footprint_path - string, optional, path to footprint csv file</span>
<span class="sd">    kw:</span>
<span class="sd">        path - string, path/name of output file&quot;&quot;&quot;</span>

    <span class="c1">#load and export the results</span>
    <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">load_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="cumulative_distance"><p class="function-str"><span class="function-name">cumulative_distance</span>(*<span class="function-arg">args</span>)</p><p class="docstr">calculate the cumlative linear distances along a path of x,y coordinates, including the first point (the returned array always starts with zero)<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;either a single iterable of points or separate iterables containing<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the coordinates. Can accept two or three dimensional input.<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;dist - array, cumulative distance along the points</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cumulative_distance</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;calculate the cumlative linear distances along a path of x,y coordinates,
    including the first point (the returned array always starts with zero)
    args:</span>
<span class="sd">        either a single iterable of points or separate iterables containing</span>
<span class="sd">        the coordinates. Can accept two or three dimensional input.</span>
<span class="sd">    returns:</span>
<span class="sd">        dist - array, cumulative distance along the points&quot;&quot;&quot;</span>

    <span class="n">largs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">largs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">_cum_dist_2D</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">_cum_dist_3D</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Input error. cumulative_distance
            accepts either a single iterable of points or separate iterables
            containing the coordinates. Can accept two or three dimensional
            input.&quot;</span><span class="p">))</span><span class="n">
</span>    <span class="k">elif</span><span class="p">(</span><span class="n">largs</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Inputs must have the same length.&quot;</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="n">_cum_dist_2D</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">largs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]))):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Inputs must have the same length.&quot;</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="n">_cum_dist_3D</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Cannot accept more than three inputs.&quot;</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="drop_footprint_template"><p class="function-str"><span class="function-name">drop_footprint_template</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Copy the emf.subcalc footprint template in the current directory or a directory specified by an input string<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;drop_path - string, path of copied template file</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drop_footprint_template</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy the emf.subcalc footprint template in the current directory or a
    directory specified by an input string
    args:</span>
<span class="sd">        drop_path - string, path of copied template file&quot;&quot;&quot;</span>
    <span class="c1">#check inputs</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">fields_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;drop_footprint_template only accepts zero
        or one input argument. A string can be passed to specify the directory
        in which the template file is copied. With no arguments, the template
        file is copied into the current directory.&quot;&quot;&quot;</span><span class="p">))</span><span class="n">
</span>    <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
    <span class="c1">#get template file path</span>
    <span class="n">fn_template</span> <span class="o">=</span> <span class="n">_resource_filename</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="s1">&#39;subcalc-footprint-template.xlsx&#39;</span><span class="p">)</span>
    <span class="c1">#get drop path</span>
    <span class="n">fn_drop</span> <span class="o">=</span> <span class="n">_path_manage</span><span class="p">(</span><span class="s1">&#39;subcalc-footprint-template&#39;</span><span class="p">,</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="c1">#check for existing files</span>
    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn_drop</span><span class="p">)):</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;A file with the path &quot;</span><span class="si">%s</span><span class="s1">&quot; already exists.
        Move/delete it or pass a new path string to drop_footprint_template().&#39;</span><span class="n">
</span>        <span class="o">%</span> <span class="n">fn_drop</span><span class="p">))</span><span class="n">
</span>    <span class="c1">#copy and notify</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">fn_template</span><span class="p">,</span> <span class="n">fn_drop</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;subcalc footprint template written to: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fn_drop</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="drop_tower_template"><p class="function-str"><span class="function-name">drop_tower_template</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Copy the emf.subcalc tower template in the current directory or a directory specified by an input string<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;drop_path - string, path of copied template file</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drop_tower_template</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy the emf.subcalc tower template in the current directory or a
    directory specified by an input string
    args:</span>
<span class="sd">        drop_path - string, path of copied template file&quot;&quot;&quot;</span>
    <span class="c1">#check inputs</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">fields_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;drop_tower_template only accepts zero or
        one input argument. A string can be passed to specify the directory in
        which the template file is copied. With no arguments, the template file
        is copied into the current directory.&quot;&quot;&quot;</span><span class="p">))</span><span class="n">
</span>    <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
    <span class="c1">#get template file path</span>
    <span class="n">fn_template</span> <span class="o">=</span> <span class="n">_resource_filename</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="s1">&#39;subcalc-tower-template.xlsx&#39;</span><span class="p">)</span>
    <span class="c1">#get drop path</span>
    <span class="n">fn_drop</span> <span class="o">=</span> <span class="n">_path_manage</span><span class="p">(</span><span class="s1">&#39;subcalc-tower-template&#39;</span><span class="p">,</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="c1">#check for existing files</span>
    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn_drop</span><span class="p">)):</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;A file with the path &quot;</span><span class="si">%s</span><span class="s1">&quot; already exists.
        Move/delete it or pass a new path string to drop_tower_template().&#39;</span> <span class="o">%</span><span class="n">
</span>        <span class="n">fn_drop</span><span class="p">))</span><span class="n">
</span>    <span class="c1">#copy and notify</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">fn_template</span><span class="p">,</span> <span class="n">fn_drop</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;subcalc tower template written to: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fn_drop</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="grid_segment_results"><p class="function-str"><span class="function-name">grid_segment_results</span>(<span class="function-arg">Ph_x</span>, <span class="function-arg">Ph_y</span>, <span class="function-arg">Ph_z</span>, <span class="function-arg">x</span>, <span class="function-arg">y</span>)</p><p class="docstr">Convert the flat arrays returned by B_field_grid into 2D arrays<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_x - complex 1D numpy array representing phasors in the x direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_y - complex 1D numpy array representing phasors in the y direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_z - complex 1D numpy array representing phasors in the z direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - 1D numpy array, sorted x coordinates of sample grid (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - 1D numpy array, sorted y coordinates of sample grid (ft)<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_x_grid - complex 2D numpy array, phasors in the x direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_y_grid - complex 2D numpy array, phasors in the y direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_z_grid - complex 2D numpy array, phasors in the z direction<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;X - 2D array containing x coordinates of the sample grid<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Y - 2D array containing y coordinates of the sample grid</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_segment_results</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span> <span class="n">Ph_y</span><span class="p">,</span> <span class="n">Ph_z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert the flat arrays returned by B_field_grid into 2D arrays</span>
<span class="sd">    args:</span>
<span class="sd">        Ph_x - complex 1D numpy array representing phasors in the x direction</span>
<span class="sd">        Ph_y - complex 1D numpy array representing phasors in the y direction</span>
<span class="sd">        Ph_z - complex 1D numpy array representing phasors in the z direction</span>
<span class="sd">        x - 1D numpy array, sorted x coordinates of sample grid (ft)</span>
<span class="sd">        y - 1D numpy array, sorted y coordinates of sample grid (ft)</span>
<span class="sd">    returns:</span>
<span class="sd">        Ph_x_grid - complex 2D numpy array, phasors in the x direction</span>
<span class="sd">        Ph_y_grid - complex 2D numpy array, phasors in the y direction</span>
<span class="sd">        Ph_z_grid - complex 2D numpy array, phasors in the z direction</span>
<span class="sd">        X - 2D array containing x coordinates of the sample grid</span>
<span class="sd">        Y - 2D array containing y coordinates of the sample grid&quot;&quot;&quot;</span>

    <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">Ph_x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span> <span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Ph_y_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Ph_y</span><span class="p">,</span> <span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Ph_z_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Ph_z</span><span class="p">,</span> <span class="p">(</span><span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">Ph_x_grid</span><span class="p">,</span> <span class="n">Ph_y_grid</span><span class="p">,</span> <span class="n">Ph_z_grid</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="ion"><p class="function-str"><span class="function-name">ion</span>()</p><p class="docstr">Call plt.ion() to toggle interactive plotting on</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ion</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Call plt.ion() to toggle interactive plotting on&quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="load_results"><p class="function-str"><span class="function-name">load_results</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Read a .REF output file and load the data into a Results object<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;results_path - string, path to the output .REF file of field results or to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the excel file exported by a Results object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;footprint_path - string, optional, path to the csv file of<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; footprint data<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Bkey - string, sets 'component' of magnetic field results that the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   returned Results object accesses by default<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; - can be 'Bx', 'By', 'Bz', 'Bmax', or 'Bres'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; - default is 'Bmax'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; - all components are stored, none are lost<br>&ensp;&ensp;&ensp;&ensp;returns<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;res - Results object containing results</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_results</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read a .REF output file and load the data into a Results object</span>
<span class="sd">    args:</span>
<span class="sd">        results_path - string, path to the output .REF file of field results or to</span>
<span class="sd">                the excel file exported by a Results object</span>
<span class="sd">        footprint_path - string, optional, path to the csv file of</span>
<span class="sd">                         footprint data</span>
<span class="sd">    kw:</span>
<span class="sd">        Bkey - string, sets &#39;component&#39; of magnetic field results that the</span>
<span class="sd">               returned Results object accesses by default</span>
<span class="sd">                     - can be &#39;Bx&#39;, &#39;By&#39;, &#39;Bz&#39;, &#39;Bmax&#39;, or &#39;Bres&#39;</span>
<span class="sd">                     - default is &#39;Bmax&#39;</span>
<span class="sd">                     - all components are stored, none are lost</span>
<span class="sd">    returns</span>
<span class="sd">        res - Results object containing results&quot;&quot;&quot;</span>

    <span class="c1">#check for a Bkey kwarg</span>
    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;Bkey&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
        <span class="n">Bkey</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;Bkey&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Bkey</span> <span class="o">=</span> <span class="s1">&#39;Bmax&#39;</span>

    <span class="c1">#check extensions</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">_check_extension</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.REF&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">):</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">_check_extension</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Can only load Results from .REF or .xlsx files&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;REF&#39;</span><span class="p">):</span>

        <span class="c1">#pull data from the REF file</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">SUBCALC_io</span><span class="o">.</span><span class="n">read_REF</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1">#get the gridded arrays</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">mesh_dict_grids</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1">#initialize Results object</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Results</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">Bkey</span><span class="o">=</span><span class="n">Bkey</span><span class="p">)</span>
        <span class="c1">#check for footprint file path and load if present</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">load_footprints</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">elif</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">):</span>
        <span class="c1">#get a dict of all sheets in excel file</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sheetname</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">bkeys</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;info&#39;</span> <span class="ow">in</span> <span class="n">bkeys</span><span class="p">):</span>
            <span class="n">bkeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;footprints&#39;</span> <span class="ow">in</span> <span class="n">bkeys</span><span class="p">):</span>
            <span class="n">bkeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;footprints&#39;</span><span class="p">)</span>
        <span class="c1">#slice out grid data</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">[</span><span class="n">bkeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">[</span><span class="n">bkeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bkeys</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="c1">#slice out info dictionary</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;info&#39;</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">):</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
            <span class="c1">#initialize Results with metadata</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Results</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">Bkey</span><span class="o">=</span><span class="n">Bkey</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#initialize Results object without metadata dict</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Results</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Bkey</span><span class="o">=</span><span class="n">Bkey</span><span class="p">)</span>

        <span class="c1">#check for footprints</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1">#check for footprint file path and load if present</span>
            <span class="n">res</span><span class="o">.</span><span class="n">load_footprints</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span><span class="p">(</span><span class="s1">&#39;footprints&#39;</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">load_footprints</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;footprints&#39;</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Results must be loaded from .REF file or excel files&quot;&quot;&quot;</span><span class="p">))</span>

    <span class="c1">#set the Results object&#39;s name with the input filename</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">[:</span><span class="n">n</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span>
    <span class="n">res</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>

    <span class="c1">#return</span>
    <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="load_towers"><p class="function-str"><span class="function-name">load_towers</span>(<span class="function-arg">fn</span>, <span class="function-arg">return_model</span>=<span class="function-arg">False</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Read an emf.subcalc tower template or a SUBCALC INP file and create a new list of Tower objects. The list of Tower objects is returned by default, but a new Model object containing the Tower objects can be returned by using return_model=True.<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fn - string, the path string to the emf.subcalc tower template file<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; (excel or csv) or a SUBCALC INP file<br>&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;return_model - bool, if False, a list of Tower objects is returned.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   If True, a new Model object containing the Towers is<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   returned.<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - string, if the template file is an excel workbook with multiple sheets,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the target sheet must be specified<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;a list of Towers or a Model object, depending on return_model</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_towers</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">return_model</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read an emf.subcalc tower template or a SUBCALC INP file and create a new
    list of Tower objects. The list of Tower objects is returned by default, but
    a new Model object containing the Tower objects can be returned by using
    return_model=True.
    args:</span>
<span class="sd">        fn - string, the path string to the emf.subcalc tower template file</span>
<span class="sd">             (excel or csv) or a SUBCALC INP file</span>
<span class="sd">    optional args:</span>
<span class="sd">        return_model - bool, if False, a list of Tower objects is returned.</span>
<span class="sd">                       If True, a new Model object containing the Towers is</span>
<span class="sd">                       returned.</span>
<span class="sd">    kw:</span>
<span class="sd">        sheet - string, if the template file is an excel workbook with multiple sheets,</span>
<span class="sd">                the target sheet must be specified</span>
<span class="sd">    returns:</span>
<span class="sd">        a list of Towers or a Model object, depending on return_model&quot;&quot;&quot;</span>

    <span class="c1">#check if the target file is an INP</span>
    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;.INP&#39;</span> <span class="ow">in</span> <span class="n">fn</span><span class="p">):</span>
        <span class="n">towers</span> <span class="o">=</span> <span class="n">SUBCALC_io</span><span class="o">.</span><span class="n">read_INP</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#load the template file into a DataFrame</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">fn</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">fn</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">):</span>
                <span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">sheetname</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;sheet&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;sheet&#39;</span><span class="p">]</span>
                        <span class="n">df</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;If an excel file with
                        multiple sheets is passed to load_towers, the target
                        sheet must be specified with the keyword argument
                        &#39;sheet&#39;.&quot;&quot;&quot;</span><span class="p">))</span><span class="n">
</span>                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">):</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">):</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Only csv, xlsx, and INP files can
                be passed to load_towers.&quot;</span><span class="p">))</span><span class="n">
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;No extension was detected at the end
            of file name &quot;</span><span class="si">%s</span><span class="s2">&quot; passed to load_towers. File names passed to
            load_towers must have .csv or .xlsx extensions.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">fn</span><span class="p">))</span><span class="n">
</span>        <span class="c1">#condition data a little</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
        <span class="c1">#match the columns with string distance method</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;sequence&#39;</span><span class="p">,</span> <span class="s1">&#39;tower x&#39;</span><span class="p">,</span> <span class="s1">&#39;tower y&#39;</span><span class="p">,</span> <span class="s1">&#39;rotation&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">_Levenshtein_group</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
        <span class="c1">#parse to Towers</span>
        <span class="n">towers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">seq</span><span class="p">),</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;group&#39;</span><span class="p">,</span><span class="s1">&#39;sequence&#39;</span><span class="p">]):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Tower</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tower x&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tower y&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;rotation&#39;</span><span class="p">],</span>
                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">towers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="c1">#return Towers directly or in a Model</span>
    <span class="k">if</span><span class="p">(</span><span class="n">return_model</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-towers&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">towers</span><span class="o">=</span><span class="n">towers</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">towers</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="mesh_dict_grids"><p class="function-str"><span class="function-name">mesh_dict_grids</span>(<span class="function-arg">flat_data</span>)</p><p class="docstr">Convert raw grid data read from a SubCalc output file (by the read_REF function) into meshed grids of X, Y coordinates and their corresponding B field values. This function would generally only be used on the results of subcalc_funks.read_REF to reshape 1D arrays of values pulled from REF files. However, the load_results function calls these functions to read a REF file, reshape the results, and return them in a Results object. Thus, the load_results function is almost always the more convenient way to load REF data into Python objects.<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;flat_data - dict, keyed by 'x', 'y', 'bx', 'by', 'bz', 'bmax', 'bres'<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;grid_data - dict with 2D arrays keyed by<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;'X', 'Y', 'Bx', 'By', 'Bz', 'Bmax', 'Bres'</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mesh_dict_grids</span><span class="p">(</span><span class="n">flat_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert raw grid data read from a SubCalc output file (by the read_REF
    function) into meshed grids of X, Y coordinates and their corresponding B
    field values. This function would generally only be used on the results of
    subcalc_funks.read_REF to reshape 1D arrays of values pulled from REF files.
    However, the load_results function calls these functions to read a REF file,
    reshape the results, and return them in a Results object. Thus, the
    load_results function is almost always the more convenient way to load REF
    data into Python objects.
    args:</span>
<span class="sd">        flat_data - dict, keyed by &#39;x&#39;, &#39;y&#39;, &#39;bx&#39;, &#39;by&#39;, &#39;bz&#39;, &#39;bmax&#39;, &#39;bres&#39;</span>
<span class="sd">    returns:</span>
<span class="sd">        grid_data - dict with 2D arrays keyed by</span>
<span class="sd">                &#39;X&#39;, &#39;Y&#39;, &#39;Bx&#39;, &#39;By&#39;, &#39;Bz&#39;, &#39;Bmax&#39;, &#39;Bres&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#find the number of points in a row</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">flat_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">flat_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">while</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#get ncols and nrows</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="n">count</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">L</span><span class="o">/</span><span class="n">ncols</span>
    <span class="c1">#map old to new keys</span>
    <span class="n">mapk</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;bx&#39;</span><span class="p">,</span><span class="s1">&#39;by&#39;</span><span class="p">,</span><span class="s1">&#39;bz&#39;</span><span class="p">,</span><span class="s1">&#39;bmax&#39;</span><span class="p">,</span><span class="s1">&#39;bres&#39;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Bx&#39;</span><span class="p">,</span><span class="s1">&#39;By&#39;</span><span class="p">,</span><span class="s1">&#39;Bz&#39;</span><span class="p">,</span><span class="s1">&#39;Bmax&#39;</span><span class="p">,</span><span class="s1">&#39;Bres&#39;</span><span class="p">]))</span>
    <span class="c1">#replace with 2D arrays</span>
    <span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">mapk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flat_data</span><span class="p">]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">flat_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flat_data</span><span class="p">]</span>
    <span class="n">grid_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">grid_data</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="phasors_to_magnitudes"><p class="function-str"><span class="function-name">phasors_to_magnitudes</span>(<span class="function-arg">Ph_x</span>, <span class="function-arg">Ph_y</span>, <span class="function-arg">Ph_z</span>)</p><p class="docstr">Convert vectors of complex x, y, and z phasors into real quantities, namely the amplitude of the field in the x, y, and z directions, the product/resultant (the hypotenuse of the amplitudes), and the time-dependent maximum field<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_x - complex 3D numpy array, phasor x components<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_y - complex 3D numpy array, phasor y components<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Ph_z - complex 3D numpy array, phasor z components<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;mag_x - 3D numpy array, maximum x field<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;mag_y - 3D numpy array, maximum y field<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;mag_z - 3D numpy array, maximum z field<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;prod - 3D numpy array, sqrt(mag_x**2 + mag_y**2)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;maximum - 3D numpy array, maximum field at any time</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">phasors_to_magnitudes</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span> <span class="n">Ph_y</span><span class="p">,</span> <span class="n">Ph_z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert vectors of complex x, y, and z phasors into real quantities,
    namely the amplitude of the field in the x, y, and z directions, the
    product/resultant (the hypotenuse of the amplitudes), and the time-dependent
    maximum field
    args:</span>
<span class="sd">        Ph_x - complex 3D numpy array, phasor x components</span>
<span class="sd">        Ph_y - complex 3D numpy array, phasor y components</span>
<span class="sd">        Ph_z - complex 3D numpy array, phasor z components</span>
<span class="sd">    returns:</span>
<span class="sd">        mag_x - 3D numpy array, maximum x field</span>
<span class="sd">        mag_y - 3D numpy array, maximum y field</span>
<span class="sd">        mag_z - 3D numpy array, maximum z field</span>
<span class="sd">        prod - 3D numpy array, sqrt(mag_x**2 + mag_y**2)</span>
<span class="sd">        maximum - 3D numpy array, maximum field at any time&quot;&quot;&quot;</span>

    <span class="c1">#amplitude along each component, storing squared magnitudes for later</span>
    <span class="n">mag_x_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">mag_x</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mag_x_sq</span><span class="p">)</span>
    <span class="n">mag_y_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ph_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ph_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">mag_y</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mag_y_sq</span><span class="p">)</span>
    <span class="n">mag_z_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ph_z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ph_z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">mag_z</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mag_z_sq</span><span class="p">)</span>

    <span class="c1">#phase angle of each component</span>
    <span class="n">phase_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">))</span>
    <span class="n">phase_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ph_y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ph_y</span><span class="p">))</span>
    <span class="n">phase_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ph_z</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ph_z</span><span class="p">))</span>

    <span class="c1">#&quot;product&quot;</span>
    <span class="n">prod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mag_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mag_y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mag_z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#maximum resultant value found by setting the time derivative of the</span>
    <span class="c1">#squared resultant magnitude to zero (Appendix 8.1 EPRI&#39;s &quot;Big Red Book&quot;)</span>
    <span class="n">num</span>     <span class="o">=</span> <span class="p">(</span><span class="n">mag_x_sq</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phase_x</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">mag_y_sq</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phase_y</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">mag_z_sq</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phase_z</span><span class="p">))</span>
    <span class="n">den</span>     <span class="o">=</span> <span class="p">(</span><span class="n">mag_x_sq</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phase_x</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">mag_y_sq</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phase_y</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">mag_z_sq</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phase_z</span><span class="p">))</span>
    <span class="n">t1</span>      <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">num</span><span class="p">,</span> <span class="n">den</span><span class="p">)</span>
    <span class="n">t2</span>      <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">x_term</span>  <span class="o">=</span> <span class="n">mag_x_sq</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">phase_x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">y_term</span>  <span class="o">=</span> <span class="n">mag_y_sq</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">phase_y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">z_term</span>  <span class="o">=</span> <span class="n">mag_z_sq</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">phase_z</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">ax_mag1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_term</span> <span class="o">+</span> <span class="n">y_term</span> <span class="o">+</span> <span class="n">z_term</span><span class="p">)</span>
    <span class="n">x_term</span>  <span class="o">=</span> <span class="n">mag_x_sq</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t2</span> <span class="o">+</span> <span class="n">phase_x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">y_term</span>  <span class="o">=</span> <span class="n">mag_y_sq</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t2</span> <span class="o">+</span> <span class="n">phase_y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">z_term</span>  <span class="o">=</span> <span class="n">mag_z_sq</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t2</span> <span class="o">+</span> <span class="n">phase_z</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">ax_mag2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_term</span> <span class="o">+</span> <span class="n">y_term</span> <span class="o">+</span> <span class="n">z_term</span><span class="p">)</span>

    <span class="c1">#pick out the semi-major axis magnitude from the two semi-axis results</span>
    <span class="n">maximum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">ax_mag1</span><span class="p">,</span> <span class="n">ax_mag2</span><span class="p">)</span>

    <span class="c1">#return the 5 output columns</span>
    <span class="k">return</span><span class="p">(</span><span class="n">mag_x</span><span class="p">,</span> <span class="n">mag_y</span><span class="p">,</span> <span class="n">mag_z</span><span class="p">,</span> <span class="n">prod</span><span class="p">,</span> <span class="n">maximum</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="plot_contour"><p class="function-str"><span class="function-name">plot_contour</span>(<span class="function-arg">res</span>, <span class="function-arg">scale</span>=<span class="default-str">'lin'</span>, <span class="function-arg">show_max</span>=<span class="function-arg">True</span>, <span class="function-arg">fp_max</span>=<span class="function-arg">True</span>, <span class="function-arg">fp_text</span>=<span class="function-arg">True</span>, <span class="function-arg">cmap</span>=<span class="default-str">'viridis_r'</span>, <span class="function-arg">max_fig_width</span>=<span class="function-arg">12</span>, <span class="function-arg">max_fig_height</span>=<span class="function-arg">8</span>, <span class="function-arg">legend_padding</span>=<span class="function-arg">3</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Generate a contour plot from the magnetic field results and<br>&ensp;&ensp;&ensp;&ensp;Footprint objects stored in a Results object<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;res - Results object<br>&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;scale - str, can be 'log' or 'lin' (default is 'lin')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;show_max - bool, toggle labeling of the maximum field location,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fp_max - bool, toggle whether the maximum fields along footprints<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; "of concern" are labeled<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fp_text - bool, toggle footprint group labeling with text<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;cmap - str, name of matplotlib colormap, see:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   http://matplotlib.org/examples/color/colormaps_reference.html<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_fig_width - float/int, inches, maximum width of figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_fig_height - float/int, inches, maximum height of figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;legend_padding - float/int, inches, width left for legend area<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;levels - iterable, determines contour level values<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; (automatically determined by matplotlib if unused)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;north_angle - number, direction of north arrow<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  (0 is along +y axis and clockwise is increasing)<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle whether the figure is saved<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, path to directory for saved figure. If set, overrides<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the 'save' keyword<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - matplotlib figure object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - matplotlib axes object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;CS - matplotlib QuadContourSet object</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_contour</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="n">show_max</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fp_max</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fp_text</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">,</span> <span class="n">max_fig_width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">max_fig_height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">legend_padding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a contour plot from the magnetic field results and</span>
<span class="sd">    Footprint objects stored in a Results object</span>
<span class="sd">    args:</span>
<span class="sd">        res - Results object</span>
<span class="sd">    optional args:</span>
<span class="sd">        scale - str, can be &#39;log&#39; or &#39;lin&#39; (default is &#39;lin&#39;)</span>
<span class="sd">        show_max - bool, toggle labeling of the maximum field location,</span>
<span class="sd">                    default is True</span>
<span class="sd">        fp_max - bool, toggle whether the maximum fields along footprints</span>
<span class="sd">                 &quot;of concern&quot; are labeled</span>
<span class="sd">        fp_text - bool, toggle footprint group labeling with text</span>
<span class="sd">        cmap - str, name of matplotlib colormap, see:</span>
<span class="sd">               http://matplotlib.org/examples/color/colormaps_reference.html</span>
<span class="sd">        max_fig_width - float/int, inches, maximum width of figure</span>
<span class="sd">        max_fig_height - float/int, inches, maximum height of figure</span>
<span class="sd">        legend_padding - float/int, inches, width left for legend area</span>
<span class="sd">    kw:</span>
<span class="sd">        levels - iterable, determines contour level values</span>
<span class="sd">                 (automatically determined by matplotlib if unused)</span>
<span class="sd">        north_angle - number, direction of north arrow</span>
<span class="sd">                      (0 is along +y axis and clockwise is increasing)</span>

<span class="sd">        save - bool, toggle whether the figure is saved</span>
<span class="sd">        path - string, path to directory for saved figure. If set, overrides</span>
<span class="sd">                the &#39;save&#39; keyword</span>
<span class="sd">        format - string, saved plot format/extension (default &#39;png&#39;)</span>
<span class="sd">    returns:</span>
<span class="sd">        fig - matplotlib figure object</span>
<span class="sd">        ax - matplotlib axes object</span>
<span class="sd">        CS - matplotlib QuadContourSet object&quot;&quot;&quot;</span>

    <span class="c1">#get a colormap object</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">_get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c1">#generate the plot objects</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_equal_ax_objs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span>
            <span class="n">max_fig_width</span><span class="p">,</span> <span class="n">max_fig_height</span><span class="p">,</span> <span class="n">legend_padding</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>

    <span class="c1">#get contour plotting keyword arguments</span>
    <span class="n">contour_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="n">cmap</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">_contour_alpha</span><span class="p">}</span>
    <span class="c1">#get levels if passed in</span>
    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;levels&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
        <span class="n">contour_kw</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="c1">#determine contour scaling kwarg</span>
    <span class="k">if</span><span class="p">(</span><span class="n">scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">contour_kw</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">()</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">scale</span> <span class="o">==</span> <span class="s1">&#39;lin&#39;</span><span class="p">):</span>
        <span class="n">contour_kw</span><span class="p">[</span><span class="s1">&#39;locator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Invalid value passed to keyword argument &#39;scale.&#39;</span>
<span class="s2">        Must be &#39;log&#39; or &#39;lin.&#39;&quot;&quot;&quot;</span><span class="p">))</span>

    <span class="c1">#plot</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="o">**</span><span class="n">contour_kw</span><span class="p">)</span>

    <span class="c1">#get color indexer from decorator along the way</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">_make_color_indexer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">CS</span><span class="o">.</span><span class="n">cvalues</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">CS</span><span class="o">.</span><span class="n">cvalues</span><span class="p">),</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">),</span> <span class="n">scale</span><span class="p">)</span>

    <span class="c1">#set the contour linewidths private variable...</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">_linewidths</span> <span class="o">=</span> <span class="p">(</span><span class="n">_contour_linewidths</span><span class="p">,)</span>

    <span class="c1">#keep list of handles and labels for the legend</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="c1">#plot location of maximum field</span>
    <span class="k">if</span><span class="p">(</span><span class="n">show_max</span><span class="p">):</span>
        <span class="n">peak_B</span><span class="p">,</span> <span class="n">yidx</span><span class="p">,</span> <span class="n">xidx</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_2Dmax</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
        <span class="n">peak_B</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_sig_figs</span><span class="p">(</span><span class="n">peak_B</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">xidx</span><span class="p">],</span> <span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">yidx</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="n">_field_marker_size</span><span class="p">,</span>
                <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">markeredgewidth</span><span class="o">=</span><span class="n">_field_marker_edgewidth</span><span class="p">,</span>
                <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Maximum Modeled</span><span class="se">\n</span><span class="s1">Magnetic Field</span><span class="se">\n</span><span class="s1">(</span><span class="si">%s</span><span class="s1"> mG)&#39;</span> <span class="o">%</span> <span class="n">peak_B</span><span class="p">)</span>

    <span class="c1">#plot footprints</span>
    <span class="n">H</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">_plot_footprints</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">fp_max</span><span class="p">,</span> <span class="n">fp_text</span><span class="p">)</span>
    <span class="n">handles</span> <span class="o">+=</span> <span class="n">H</span>
    <span class="n">labels</span> <span class="o">+=</span> <span class="n">L</span>

    <span class="c1">#legend</span>
    <span class="n">cvalues</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_check_intable</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; mG&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">CS</span><span class="o">.</span><span class="n">cvalues</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">CS</span><span class="o">.</span><span class="n">collections</span> <span class="o">+</span> <span class="n">handles</span><span class="p">,</span> <span class="n">cvalues</span> <span class="o">+</span> <span class="n">labels</span><span class="p">,</span>
            <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.025</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
            <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#north arrow</span>
    <span class="k">if</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">north_angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">_draw_north_arrow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">north_angle</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span><span class="s1">&#39;north_angle&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
        <span class="n">_draw_north_arrow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;north_angle&#39;</span><span class="p">])</span>

    <span class="c1">#axes text</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X (ft)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y (ft)&#39;</span><span class="p">)</span>

    <span class="c1">#final formatting</span>
    <span class="n">_format_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1">#write Bkey note</span>
    <span class="n">_write_Bkey</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>

    <span class="c1">#saving</span>
    <span class="n">_save_fig</span><span class="p">(</span><span class="s1">&#39;contour-plot&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">CS</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="plot_cross_sections"><p class="function-str"><span class="function-name">plot_cross_sections</span>(<span class="function-arg">obj</span>, <span class="function-arg">paths</span>, <span class="function-arg">xs_label_size</span>=<span class="function-arg">12</span>, <span class="function-arg">xs_color</span>=<span class="default-str">'black'</span>, <span class="function-arg">map_style</span>=<span class="default-str">'contour'</span>, <span class="function-arg">scale</span>=<span class="default-str">'lin'</span>, <span class="function-arg">n</span>=<span class="function-arg">101</span>, <span class="function-arg">x_labeling</span>=<span class="default-str">'distance'</span>, <span class="function-arg">show_max</span>=<span class="function-arg">True</span>, <span class="function-arg">fp_max</span>=<span class="function-arg">True</span>, <span class="function-arg">fp_text</span>=<span class="function-arg">True</span>, <span class="function-arg">cmap</span>=<span class="default-str">'viridis_r'</span>, <span class="function-arg">max_fig_width</span>=<span class="function-arg">12</span>, <span class="function-arg">max_fig_height</span>=<span class="function-arg">8</span>, <span class="function-arg">legend_padding</span>=<span class="function-arg">6</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Generate a map style plot (either contour or pcolormesh) with<br>&ensp;&ensp;&ensp;&ensp;cross sections labeled on it and generate plots of the fields corresponding<br>&ensp;&ensp;&ensp;&ensp;to the cross sections<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;obj - Results object or Model object, because the grid of fields<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  in a Results object must be interpolated to compute fields<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  along each cross section, passing a Model object instead will<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  yield smoother profiles of the fields along each cross section.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  The Model object will, however, be used to compute a grid of<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  fields for the map style plot (contour or pcolormesh), so<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  passing a Model object could be slower.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;paths - An iterable of iterables of x,y pairs representing paths through<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the results domain to plot as cross sections. For example,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;([(1,2), (3,5)], [(2,5), (9,3), (4,7)], [(5,3), (9,2)])<br>&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs_label_size - int, fontsize of text labels on the map style figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xs_color - any matplotlib compatible color definition<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;map_style - str, 'contour' or 'pcolormesh', determines which map style<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;plot is generated with the cross sections labeled on it,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is 'contour'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;scale - str, can be 'log' or 'lin', only applies if map_style is<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;'contour' (default is 'lin')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;n - integer, number of points sampled along the sections (default 101)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_labeling - 'distance' or 'location', for x axis ticks on the cross<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  section plots labeled according to the distance along<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  the segment or with the (x,y) coordinates of sample<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  points, default is 'distance'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;show_max - bool, toggle labeling of the maximum field location,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fp_max - bool, toggle whether the maximum fields along footprints<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; "of concern" are labeled<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fp_text - bool, toggle footprint group labeling with text<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;cmap - str, name of matplotlib colormap, see:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   http://matplotlib.org/examples/color/colormaps_reference.html<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_fig_width - float/int, inches, maximum width of figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_fig_height - float/int, inches, maximum height of figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;legend_padding - float/int, inches, width left for legend area<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;prefix - string prepended to the file names of saved plots<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;suffix - string appended to the file names of saved plots<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;and<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;any keyword arguments that can be passed to plot_contour(),<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;plot_pcolormesh(), or plot_segment()<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;note: Only a directory name can be passed to the 'path' keyword.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  File names aren't accepted, which prevents saved plots from<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  overwriting each other. File names are created automatically.<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;A tuple of tuples of plotting objects. The first tuple contains the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;return arguments of the map plot (contour or pcolormesh) and the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;other tuples contain the return arguments of plot_path, for however<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;many cross sections are created.</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_cross_sections</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">xs_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">xs_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
        <span class="n">map_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_labeling</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span>
        <span class="n">show_max</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fp_max</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fp_text</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">,</span>
        <span class="n">max_fig_width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">max_fig_height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">legend_padding</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a map style plot (either contour or pcolormesh) with</span>
<span class="sd">    cross sections labeled on it and generate plots of the fields corresponding</span>
<span class="sd">    to the cross sections</span>
<span class="sd">    args:</span>
<span class="sd">        obj - Results object or Model object, because the grid of fields</span>
<span class="sd">              in a Results object must be interpolated to compute fields</span>
<span class="sd">              along each cross section, passing a Model object instead will</span>
<span class="sd">              yield smoother profiles of the fields along each cross section.</span>
<span class="sd">              The Model object will, however, be used to compute a grid of</span>
<span class="sd">              fields for the map style plot (contour or pcolormesh), so</span>
<span class="sd">              passing a Model object could be slower.</span>
<span class="sd">        paths - An iterable of iterables of x,y pairs representing paths through</span>
<span class="sd">                the results domain to plot as cross sections. For example,</span>
<span class="sd">                    ([(1,2), (3,5)], [(2,5), (9,3), (4,7)], [(5,3), (9,2)])</span>
<span class="sd">    optional args:</span>
<span class="sd">        xs_label_size - int, fontsize of text labels on the map style figure</span>
<span class="sd">        xs_color - any matplotlib compatible color definition</span>
<span class="sd">        map_style - str, &#39;contour&#39; or &#39;pcolormesh&#39;, determines which map style</span>
<span class="sd">                    plot is generated with the cross sections labeled on it,</span>
<span class="sd">                    default is &#39;contour&#39;</span>
<span class="sd">        scale - str, can be &#39;log&#39; or &#39;lin&#39;, only applies if map_style is</span>
<span class="sd">                &#39;contour&#39; (default is &#39;lin&#39;)</span>
<span class="sd">        n - integer, number of points sampled along the sections (default 101)</span>
<span class="sd">        x_labeling - &#39;distance&#39; or &#39;location&#39;, for x axis ticks on the cross</span>
<span class="sd">                      section plots labeled according to the distance along</span>
<span class="sd">                      the segment or with the (x,y) coordinates of sample</span>
<span class="sd">                      points, default is &#39;distance&#39;</span>
<span class="sd">        show_max - bool, toggle labeling of the maximum field location,</span>
<span class="sd">                    default is True</span>
<span class="sd">        fp_max - bool, toggle whether the maximum fields along footprints</span>
<span class="sd">                 &quot;of concern&quot; are labeled</span>
<span class="sd">        fp_text - bool, toggle footprint group labeling with text</span>
<span class="sd">        cmap - str, name of matplotlib colormap, see:</span>
<span class="sd">               http://matplotlib.org/examples/color/colormaps_reference.html</span>
<span class="sd">        max_fig_width - float/int, inches, maximum width of figure</span>
<span class="sd">        max_fig_height - float/int, inches, maximum height of figure</span>
<span class="sd">        legend_padding - float/int, inches, width left for legend area</span>
<span class="sd">    kw:</span>
<span class="sd">        prefix - string prepended to the file names of saved plots</span>
<span class="sd">        suffix - string appended to the file names of saved plots</span>

<span class="sd">            and</span>

<span class="sd">        any keyword arguments that can be passed to plot_contour(),</span>
<span class="sd">        plot_pcolormesh(), or plot_segment()</span>

<span class="sd">        note: Only a directory name can be passed to the &#39;path&#39; keyword.</span>
<span class="sd">              File names aren&#39;t accepted, which prevents saved plots from</span>
<span class="sd">              overwriting each other. File names are created automatically.</span>
<span class="sd">    returns:</span>
<span class="sd">        A tuple of tuples of plotting objects. The first tuple contains the</span>
<span class="sd">        return arguments of the map plot (contour or pcolormesh) and the</span>
<span class="sd">        other tuples contain the return arguments of plot_path, for however</span>
<span class="sd">        many cross sections are created.&quot;&quot;&quot;</span>

    <span class="c1">#deal with Model vs Results input</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Results</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">elif</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>

    <span class="c1">#separate saving kw from others</span>
    <span class="n">save_kw</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;suffix&#39;</span><span class="p">]:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="n">save_kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="c1">#deal with the saving kw</span>
    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="ow">in</span> <span class="n">save_kw</span><span class="p">):</span>
        <span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">fn_prefix</span> <span class="o">=</span> <span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;prefix&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fn_prefix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">fn_prefix</span> <span class="o">=</span> <span class="n">fn_prefix</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fn_prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;suffix&#39;</span> <span class="ow">in</span> <span class="n">save_kw</span><span class="p">):</span>
        <span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">fn_suffix</span> <span class="o">=</span> <span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;suffix&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fn_suffix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">fn_suffix</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">fn_suffix</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fn_suffix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;save&#39;</span> <span class="ow">in</span> <span class="n">save_kw</span><span class="p">):</span>
        <span class="n">save</span> <span class="o">=</span> <span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]</span>
    <span class="k">elif</span><span class="p">(</span><span class="s1">&#39;path&#39;</span> <span class="ow">in</span> <span class="n">save_kw</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;The path keyword argument to
            plot_cross_sections must be a directory path. Plot names are created
            automatically, with some control available through the prefix and
            suffix keyword arguments.&#39;</span><span class="p">))</span><span class="n">
</span>        <span class="n">save_kw</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">save</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">save</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1">#check inputs</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">26</span><span class="p">):</span>
        <span class="k">raise</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;There cannot be more than 26 cross
        sections on a single figure. Make sure that your input for the &quot;points&quot;
        argument has the correct number of levels (sublists).&#39;</span><span class="p">))</span><span class="n">
</span>
    <span class="c1">#list of return arguments</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#plot the map style figure</span>
    <span class="k">if</span><span class="p">(</span><span class="n">map_style</span> <span class="o">==</span> <span class="s1">&#39;contour&#39;</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">plot_contour</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">show_max</span><span class="p">,</span> <span class="n">fp_max</span><span class="p">,</span> <span class="n">fp_text</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span>
                <span class="n">max_fig_width</span><span class="p">,</span> <span class="n">max_fig_height</span><span class="p">,</span> <span class="n">legend_padding</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">fn_prefix</span> <span class="o">+</span> <span class="s1">&#39;contour-with-cross-sections&#39;</span> <span class="o">+</span> <span class="n">fn_suffix</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">plot_pcolormesh</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">show_max</span><span class="p">,</span> <span class="n">fp_max</span><span class="p">,</span> <span class="n">fp_text</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">max_fig_width</span><span class="p">,</span>
                <span class="n">max_fig_height</span><span class="p">,</span> <span class="n">legend_padding</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">fn_prefix</span> <span class="o">+</span> <span class="s1">&#39;pcolormesh-with-cross-sections&#39;</span> <span class="o">+</span> <span class="n">fn_suffix</span>
    <span class="c1">#draw cross section traces on the figure</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
        <span class="c1">#get x,y</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="p">)</span>
        <span class="n">xb</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">ye</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1">#plot the trace</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">xs_color</span><span class="p">)</span>
        <span class="c1">#label the trace</span>
        <span class="n">hab</span><span class="p">,</span> <span class="n">vab</span> <span class="o">=</span> <span class="n">_get_text_alignment</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hae</span><span class="p">,</span> <span class="n">vae</span> <span class="o">=</span> <span class="n">_get_text_alignment</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="n">hab</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">vab</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">xs_color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">xs_label_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xe</span><span class="p">,</span> <span class="n">ye</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">hae</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">vae</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">xs_color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">xs_label_size</span><span class="p">)</span>
    <span class="c1">#save or don&#39;t</span>
    <span class="k">if</span><span class="p">(</span><span class="n">save</span><span class="p">):</span>
        <span class="n">_save_fig</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">save_kw</span><span class="p">)</span>

    <span class="c1">#plot the cross sections</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">plot_path</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x_labeling</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">r</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cross Section </span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="k">if</span><span class="p">(</span><span class="n">save</span><span class="p">):</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">cross-section-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fn_prefix</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="n">fn_suffix</span><span class="p">)</span>
            <span class="n">_save_fig</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">save_kw</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="plot_path"><p class="function-str"><span class="function-name">plot_path</span>(<span class="function-arg">obj</span>, <span class="function-arg">points</span>, <span class="function-arg">n</span>=<span class="function-arg">101</span>, <span class="function-arg">x_labeling</span>=<span class="default-str">'distance'</span>, <span class="function-arg">scale</span>=<span class="default-str">'lin'</span>, <span class="function-arg">cmap</span>=<span class="default-str">'viridis_r'</span>, <span class="function-arg">edgecolors</span>=<span class="default-str">'gray'</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Plot a Results object's fields along a line segment in the results domian,<br>&ensp;&ensp;&ensp;&ensp;essentially a cross section of the fields<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;obj - Results object or Model object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;points - an iterable of x,y pairs representing a path through the results<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; domain to plot, for example: [(1,2), (1,3), (2,4)]<br>&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;n - integer, number of points sampled (default 101)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_labeling - 'distance' or 'location', for x axis ticks labeled<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  according to the distance along the segment or with<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  the (x,y) coordinates of sample points,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  default is 'distance'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;scale - str, color scaling, can be 'log' or 'lin' (default is 'lin')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;cmap - str, name of matplotlib colormap, see:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   http://matplotlib.org/examples/color/colormaps_reference.html<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;edgecolors - color or sequence of colors, to set facecolors to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; edgecolors, use 'face'<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - target Axes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object, target figure for plotting, overridden by 'ax'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle whether the figure is saved<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, path to directory for saved figure. If set, overrides<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the 'save' keyword<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - Figure object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - Axes object</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_path</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_labeling</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a Results object&#39;s fields along a line segment in the results domian,</span>
<span class="sd">    essentially a cross section of the fields</span>
<span class="sd">    args:</span>
<span class="sd">        obj - Results object or Model object</span>
<span class="sd">        points - an iterable of x,y pairs representing a path through the results</span>
<span class="sd">                 domain to plot, for example: [(1,2), (1,3), (2,4)]</span>
<span class="sd">    optional args:</span>
<span class="sd">        n - integer, number of points sampled (default 101)</span>
<span class="sd">        x_labeling - &#39;distance&#39; or &#39;location&#39;, for x axis ticks labeled</span>
<span class="sd">                      according to the distance along the segment or with</span>
<span class="sd">                      the (x,y) coordinates of sample points,</span>
<span class="sd">                      default is &#39;distance&#39;</span>
<span class="sd">        scale - str, color scaling, can be &#39;log&#39; or &#39;lin&#39; (default is &#39;lin&#39;)</span>
<span class="sd">        cmap - str, name of matplotlib colormap, see:</span>
<span class="sd">               http://matplotlib.org/examples/color/colormaps_reference.html</span>
<span class="sd">        edgecolors - color or sequence of colors, to set facecolors to</span>
<span class="sd">                     edgecolors, use &#39;face&#39;</span>
<span class="sd">    kw:</span>
<span class="sd">        ax - target Axes</span>
<span class="sd">        fig - Figure object, target figure for plotting, overridden by &#39;ax&#39;</span>
<span class="sd">        save - bool, toggle whether the figure is saved</span>
<span class="sd">        path - string, path to directory for saved figure. If set, overrides</span>
<span class="sd">                the &#39;save&#39; keyword</span>
<span class="sd">        format - string, saved plot format/extension (default &#39;png&#39;)</span>
<span class="sd">    returns:</span>
<span class="sd">        fig - Figure object</span>
<span class="sd">        ax - Axes object&quot;&quot;&quot;</span>

    <span class="c1">#get a colormap object</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">_get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c1">#compute the path</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Results</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">B_interp</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">bkey</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Bkey</span>
        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Bmin</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Bmax</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">cumulative_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">subcalc_class</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">points</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
        <span class="n">B_interp</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Bmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">bkey</span> <span class="o">=</span> <span class="s1">&#39;Bmax&#39;</span>
        <span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">B_interp</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">B_interp</span><span class="p">)</span>

    <span class="c1">#get plotting objects</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_prepare_fig</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="c1">#plot</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">_make_color_indexer</span><span class="p">(</span><span class="n">bmin</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">),</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">ci</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">B_interp</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">B_interp</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">edgecolors</span><span class="p">)</span>

    <span class="c1">#label</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetic Field ($mG$)&#39;</span><span class="p">)</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_sig_figs</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">cumulative_distance</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">points</span><span class="p">)</span>
    <span class="n">point_strings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">((</span><span class="n">sf</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">),</span> <span class="n">sf</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x_labeling</span> <span class="o">==</span> <span class="s1">&#39;location&#39;</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">point_strings</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X, Y Location ($ft$)&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance Along Path ($ft$)&#39;</span><span class="p">)</span>
    <span class="c1">#ax.set_title(&#39;Magnetic Field along %s ft Path from %s&#39; %</span>
    <span class="c1">#        (str(sf(dist[-1], 3)), &#39; to &#39;.join(point_strings)))</span>

    <span class="c1">#format</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">_format_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="c1">#tight layout</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1">#write Bkey</span>
    <span class="n">_write_Bkey</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">bkey</span><span class="p">)</span>
    <span class="c1">#save or not</span>
    <span class="n">_save_fig</span><span class="p">(</span><span class="s1">&#39;segment-plot&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="plot_pcolormesh"><p class="function-str"><span class="function-name">plot_pcolormesh</span>(<span class="function-arg">res</span>, <span class="function-arg">show_max</span>=<span class="function-arg">True</span>, <span class="function-arg">fp_max</span>=<span class="function-arg">True</span>, <span class="function-arg">fp_text</span>=<span class="function-arg">True</span>, <span class="function-arg">cmap</span>=<span class="default-str">'magma_r'</span>, <span class="function-arg">max_fig_width</span>=<span class="function-arg">12</span>, <span class="function-arg">max_fig_height</span>=<span class="function-arg">8</span>, <span class="function-arg">legend_padding</span>=<span class="function-arg">5</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Generate a color mesh plot of the magnetic field results and<br>&ensp;&ensp;&ensp;&ensp;Footprint objects stored in a Results object<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;res - Results object<br>&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;show_max - bool, toggle labeling of the maximum field location,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;default is True<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fp_max - bool, toggle whether the maximum fields along footprints<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; "of concern" are labeled<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fp_text - bool, toggle footprint group labeling with text<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;cmap - str, name of matplotlib colormap, see:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   http://matplotlib.org/examples/color/colormaps_reference.html<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_fig_width - float/int, inches, maximum width of figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;max_fig_height - float/int, inches, maximum height of figure<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;legend_padding - float/int, inches, width left for legend area<br>&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;north_angle - number, direction of north arrow<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;(0 is along +y axis and clockwise is increasing)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;save - bool, toggle whether the figure is saved<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, path to directory for saved figure. If set, overrides<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Fthe 'save' keyword<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;format - string, saved plot format/extension (default 'png')<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fig - matplotlib figure object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax - matplotlib axes object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;QM - matplotlib QuadMesh object<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ax_cbar - matplotlib Axes that the colorbar is drawn in (to which<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;legend is attached)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_pcolormesh</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">show_max</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fp_max</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fp_text</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma_r&#39;</span><span class="p">,</span> <span class="n">max_fig_width</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">max_fig_height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">legend_padding</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a color mesh plot of the magnetic field results and</span>
<span class="sd">    Footprint objects stored in a Results object</span>
<span class="sd">    args:</span>
<span class="sd">        res - Results object</span>
<span class="sd">    optional args:</span>
<span class="sd">        show_max - bool, toggle labeling of the maximum field location,</span>
<span class="sd">                    default is True</span>
<span class="sd">        fp_max - bool, toggle whether the maximum fields along footprints</span>
<span class="sd">                 &quot;of concern&quot; are labeled</span>
<span class="sd">        fp_text - bool, toggle footprint group labeling with text</span>
<span class="sd">        cmap - str, name of matplotlib colormap, see:</span>
<span class="sd">               http://matplotlib.org/examples/color/colormaps_reference.html</span>
<span class="sd">        max_fig_width - float/int, inches, maximum width of figure</span>
<span class="sd">        max_fig_height - float/int, inches, maximum height of figure</span>
<span class="sd">        legend_padding - float/int, inches, width left for legend area</span>
<span class="sd">    kw:</span>
<span class="sd">        north_angle - number, direction of north arrow</span>
<span class="sd">                        (0 is along +y axis and clockwise is increasing)</span>
<span class="sd">        save - bool, toggle whether the figure is saved</span>
<span class="sd">        path - string, path to directory for saved figure. If set, overrides</span>
<span class="sd">                Fthe &#39;save&#39; keyword</span>
<span class="sd">        format - string, saved plot format/extension (default &#39;png&#39;)</span>
<span class="sd">    returns:</span>
<span class="sd">        fig - matplotlib figure object</span>
<span class="sd">        ax - matplotlib axes object</span>
<span class="sd">        QM - matplotlib QuadMesh object</span>
<span class="sd">        ax_cbar - matplotlib Axes that the colorbar is drawn in (to which</span>
<span class="sd">                legend is attached)&quot;&quot;&quot;</span>

    <span class="c1">#get a colormap object</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">_get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c1">#generate the plot objects</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_equal_ax_objs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span>
            <span class="n">max_fig_width</span><span class="p">,</span> <span class="n">max_fig_height</span><span class="p">,</span> <span class="n">legend_padding</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>

    <span class="c1">#get plotting keyword arguments</span>
    <span class="n">pcolor_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="n">cmap</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">_pcolor_alpha</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;shading&#39;</span><span class="p">:</span> <span class="s1">&#39;gouraud&#39;</span><span class="p">}</span>

    <span class="c1">#plot</span>
    <span class="n">QM</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="o">**</span><span class="n">pcolor_kw</span><span class="p">)</span>

    <span class="c1">#get color indexer from decorator along the way</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">_make_color_indexer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">),</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">),</span> <span class="s1">&#39;lin&#39;</span><span class="p">)</span>

    <span class="c1">#keep list of handles and labels for the legend</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="c1">#plot location of maximum field</span>
    <span class="k">if</span><span class="p">(</span><span class="n">show_max</span><span class="p">):</span>
        <span class="n">peak_B</span><span class="p">,</span> <span class="n">yidx</span><span class="p">,</span> <span class="n">xidx</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_2Dmax</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
        <span class="n">peak_B</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_sig_figs</span><span class="p">(</span><span class="n">peak_B</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">xidx</span><span class="p">],</span> <span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">yidx</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="n">_field_marker_size</span><span class="p">,</span>
                <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">markeredgewidth</span><span class="o">=</span><span class="n">_field_marker_edgewidth</span><span class="p">,</span>
                <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Maximum Modeled</span><span class="se">\n</span><span class="s1">Magnetic Field</span><span class="se">\n</span><span class="s1">(</span><span class="si">%s</span><span class="s1"> mG)&#39;</span> <span class="o">%</span> <span class="n">peak_B</span><span class="p">)</span>

    <span class="c1">#plot footprints</span>
    <span class="n">H</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">_plot_footprints</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">fp_max</span><span class="p">,</span> <span class="n">fp_text</span><span class="p">)</span>
    <span class="n">handles</span> <span class="o">+=</span> <span class="n">H</span>
    <span class="n">labels</span> <span class="o">+=</span> <span class="n">L</span>

    <span class="c1">#colorbar and legend</span>
    <span class="n">ax_cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">0.2</span><span class="o">/</span><span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax_cbar</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
    <span class="n">_make_cbar</span><span class="p">(</span><span class="n">ax_cbar</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">Bmin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">Bmax</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
    <span class="n">ax_cbar</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_format_ax</span><span class="p">(</span><span class="n">ax_cbar</span><span class="p">)</span>

    <span class="c1">#north arrow</span>
    <span class="k">if</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">north_angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">_draw_north_arrow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">north_angle</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span><span class="s1">&#39;north_angle&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
        <span class="n">_draw_north_arrow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;north_angle&#39;</span><span class="p">])</span>

    <span class="c1">#axes text</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X (ft)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y (ft)&#39;</span><span class="p">)</span>

    <span class="c1">#final formatting</span>
    <span class="n">_format_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1">#write Bkey note</span>
    <span class="n">_write_Bkey</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>

    <span class="c1">#saving</span>
    <span class="n">_save_fig</span><span class="p">(</span><span class="s1">&#39;pcolormesh-plot&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">QM</span><span class="p">,</span> <span class="n">ax_cbar</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="plot_wires_3D"><p class="function-str"><span class="function-name">plot_wires_3D</span>(<span class="function-arg">mod</span>, <span class="function-arg">include_fields</span>=<span class="function-arg">False</span>, <span class="function-arg">Bkey</span>=<span class="default-str">'Bmax'</span>)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_wires_3D</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">include_fields</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">Bkey</span><span class="o">=</span><span class="s1">&#39;Bmax&#39;</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">mod</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">seg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">seg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">seg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x (ft)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y (ft)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z (ft)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">include_fields</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
        <span class="n">res</span><span class="o">.</span><span class="n">Bkey</span> <span class="o">=</span> <span class="n">Bkey</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">mod</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">Bkey</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="read_INP"><p class="function-str"><span class="function-name">read_INP</span>(<span class="function-arg">file_path</span>)</p><p class="docstr">Read a formatted SUBCALC file containing model input information and convert it to a list of emf.subcalc Tower objects. The target file must have an INP extension. These files are generated by the "Output > Ascii > Input Data" function in the SUBCALC program. To load an INP file directly in to a Model object, use the emf.subcalc.load_towers() function.<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;file_path - string, path to the target INP file<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;a list of Towers</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_INP</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read a formatted SUBCALC file containing model input information and
    convert it to a list of emf.subcalc Tower objects. The target file must have
    an INP extension. These files are generated by the &quot;Output &gt; Ascii &gt; Input
    Data&quot; function in the SUBCALC program. To load an INP file directly in to a
    Model object, use the emf.subcalc.load_towers() function.
    args:</span>
<span class="sd">        file_path - string, path to the target INP file</span>
<span class="sd">    returns:</span>
<span class="sd">        a list of Towers&quot;&quot;&quot;</span>

    <span class="c1">#check extension</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_check_extension</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;INP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Target file must have an &quot;INP&quot; extension.&#39;</span><span class="p">)</span>

    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="c1">#collect info</span>
        <span class="k">while</span><span class="p">(</span><span class="s1">&#39;Label:&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">):</span>
            <span class="k">if</span><span class="p">((</span><span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;World&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">)):</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">info</span><span class="p">[</span><span class="n">line</span><span class="p">[:</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">towers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#read to the end of the file, collecting Towers</span>
        <span class="k">while</span><span class="p">(</span><span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>

            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;Label:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">):</span>
                <span class="c1">#pull the group name for the tower group</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="c1">#advance to the numbers</span>
                <span class="k">while</span><span class="p">(</span><span class="ow">not</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_is_number</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="mi">5</span><span class="p">])):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="c1">#now read to the end of the tower group, moving through the data</span>
                <span class="n">seq</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rot</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

                <span class="k">while</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;______&#39;</span><span class="p">):</span>
                    <span class="c1">#split the line</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="c1">#check if the line defines tower seqence, x, y, and rot</span>
                    <span class="k">if</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)):</span>
                        <span class="c1">#store previous tower if there is one and clear vars</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">seq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
                            <span class="n">towers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">Tower</span><span class="p">(</span>
                                    <span class="n">group</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">phase</span><span class="p">))</span>
                            <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
                        <span class="c1">#grab new tower info</span>
                        <span class="n">seq</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rot</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">][:</span><span class="mi">4</span><span class="p">]</span>
                        <span class="n">rot</span> <span class="o">-=</span> <span class="mi">90</span>

                    <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">):</span>
                        <span class="c1">#wire information</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]]</span>
                        <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">phase</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

                    <span class="n">line</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

                <span class="c1">#store the last Tower</span>
                <span class="k">if</span><span class="p">(</span><span class="n">seq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
                    <span class="n">towers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subcalc_class</span><span class="o">.</span><span class="n">Tower</span><span class="p">(</span>
                            <span class="n">group</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">phase</span><span class="p">))</span>

            <span class="n">line</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

        <span class="k">return</span><span class="p">(</span><span class="n">towers</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="read_REF"><p class="function-str"><span class="function-name">read_REF</span>(<span class="function-arg">file_path</span>)</p><p class="docstr">Reads a .REF output file generated by the SUBCALC program, pulling out x and y coordinates for the results and all the magnetic field "components"<br>&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;file_path - string, path to saved .REF output file<br>&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;data - dict, keys are 'x', 'y', 'Bmax', 'Bres', 'Bx', 'By', and 'Bz'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;info - dict, reference grid and other information</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_REF</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reads a .REF output file generated by the SUBCALC program, pulling out x
    and y coordinates for the results and all the magnetic field &quot;components&quot;
    args:</span>
<span class="sd">        file_path - string, path to saved .REF output file</span>
<span class="sd">    returns:</span>
<span class="sd">        data - dict, keys are &#39;x&#39;, &#39;y&#39;, &#39;Bmax&#39;, &#39;Bres&#39;, &#39;Bx&#39;, &#39;By&#39;, and &#39;Bz&#39;</span>
<span class="sd">        info - dict, reference grid and other information&quot;&quot;&quot;</span>

    <span class="c1">#check the extension</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_check_extension</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;REF&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SubCalc results are saved to text files with .REF extensions.</span>
<span class="s2">        The input path:</span>
<span class="s2">            &quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="s2">        does not have the correct extension.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">file_path</span><span class="p">)</span>

    <span class="c1">#allocate dictionaries</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;REF_path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">}</span> <span class="c1">#dictionary storing reference grid information</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X Coord&#39;</span><span class="p">,</span> <span class="s1">&#39;Y Coord&#39;</span><span class="p">,</span> <span class="s1">&#39;X Mag&#39;</span><span class="p">,</span> <span class="s1">&#39;Y Mag&#39;</span><span class="p">,</span> <span class="s1">&#39;Z Mag&#39;</span><span class="p">,</span> <span class="s1">&#39;Max&#39;</span><span class="p">,</span> <span class="s1">&#39;Res&#39;</span><span class="p">]</span>
    <span class="n">return_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span> <span class="s1">&#39;by&#39;</span><span class="p">,</span> <span class="s1">&#39;bz&#39;</span><span class="p">,</span> <span class="s1">&#39;bmax&#39;</span><span class="p">,</span> <span class="s1">&#39;bres&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))]))</span>

    <span class="c1">#pull data out</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
        <span class="c1">#store information about the grid</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">ifile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">):</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[:</span><span class="n">idx</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">if</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_is_number</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_is_int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
                        <span class="n">info</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">info</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="c1">#read through the rest of the data</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ifile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="n">line</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)]):</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span>

    <span class="c1">#flatten the lists in data</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_flatten</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>

    <span class="c1">#switch the keys</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">return_keys</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id="show"><p class="function-str"><span class="function-name">show</span>()</p><p class="docstr">Call plt.show() to display open figures</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Call plt.show() to display open figures&quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

                    </div>
                </div></div></div>

                <!--classes section-->
                <div class="section" id="classes"><h2>classes</h2><div class="class" id="Conductor"><h3>Conductor</h3><p class="docstr">Conductor objects represent single wires running through a Model domain. They can be used to specify the coordinates of conductor paths directly, instead of through the properties of a Tower object. Tower and Conductor objects together are the means of creating wires in a model domain.</p><div class="function" ><p class="function-str"><span class="function-name">Conductor</span>(<span class="function-arg">name</span>, <span class="function-arg">x</span>, <span class="function-arg">y</span>, <span class="function-arg">z</span>, <span class="function-arg">I</span>, <span class="function-arg">phase</span>)</p><p class="docstr">args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;name - string, name of the conductor (i.e. 'Wire 1')<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - iterable of at least two numbers, the x coordinates of the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Conductor path in the model domain (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - iterable of at least two numbers, the y coordinates of the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Conductor path in the model domain (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;z - iterable of at least two numbers, the z coordinates of the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Conductor path in the model domain (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;I - float, amplitude of the current in the Conductor, assumed to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;flow from (x[0], y[0], z[0]) to (x[-1], y[-1], z[-1]) (Amps)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;phase - float, the phase angle of the current flow (degrees)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        args:</span>
<span class="sd">            name - string, name of the conductor (i.e. &#39;Wire 1&#39;)</span>
<span class="sd">            x - iterable of at least two numbers, the x coordinates of the</span>
<span class="sd">                Conductor path in the model domain (ft)</span>
<span class="sd">            y - iterable of at least two numbers, the y coordinates of the</span>
<span class="sd">                Conductor path in the model domain (ft)</span>
<span class="sd">            z - iterable of at least two numbers, the z coordinates of the</span>
<span class="sd">                Conductor path in the model domain (ft)</span>
<span class="sd">            I - float, amplitude of the current in the Conductor, assumed to</span>
<span class="sd">                flow from (x[0], y[0], z[0]) to (x[-1], y[-1], z[-1]) (Amps)</span>
<span class="sd">            phase - float, the phase angle of the current flow (degrees)&quot;&quot;&quot;</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_I</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="n">phase</span>
</pre></div>

                    </div>
                </div></div><div class="properties" id="Conductor-properties"><h4>Properties</h4><div class="property" id="Conductor-I"><p class="property-name">I</p><p class="docstr">amplitude of the current in the Conductor, assumed to flow from (x[0], y[0], z[0]) to (x[-1], y[-1], z[-1]) (Amps)</p></div><div class="property" id="Conductor-name"><p class="property-name">name</p><p class="docstr">Name of the Conductor</p></div><div class="property" id="Conductor-phase"><p class="property-name">phase</p><p class="docstr">the phase angle of the current flow (degrees)</p></div><div class="property" id="Conductor-x"><p class="property-name">x</p><p class="docstr">x coordinates of the Conductor path in the model domain (ft)</p></div><div class="property" id="Conductor-y"><p class="property-name">y</p><p class="docstr">y coordinates of the Conductor path in the model domain (ft)</p></div><div class="property" id="Conductor-z"><p class="property-name">z</p><p class="docstr">z coordinates of the Conductor path in the model domain (ft)</p></div></div></div><div class="class" id="Footprint"><h3>Footprint</h3><div class="function" ><p class="function-str"><span class="function-name">Footprint</span>(<span class="function-arg">name</span>, <span class="function-arg">group</span>, <span class="function-arg">x</span>, <span class="function-arg">y</span>, <span class="function-arg">power_line</span>, <span class="function-arg">of_concern</span>, <span class="function-arg">draw_as_loop</span>)</p><p class="docstr">args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;name - string, the name of the Footprint, i.e. "Substation"<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;group - string, group strings that are identical between<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Footprint objects designate them as part of the same<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;group for plotting, i.e. "Nearby Houses"<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - iterable, x coordinates of Footprint<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - iterable, y coordinates of Footprint<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;power_line - bool, True indicates the footprint corresponds to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; a modeled power line or circuit<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of_concern - bool, True if the Footprint represents an area<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; that is potentially concerned about EMF (homes)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;draw_as_loop - bool, True if the footprint should be plotted<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   as a closed loop</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">power_line</span><span class="p">,</span> <span class="n">of_concern</span><span class="p">,</span> <span class="n">draw_as_loop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        args:</span>
<span class="sd">            name - string, the name of the Footprint, i.e. &quot;Substation&quot;</span>
<span class="sd">            group - string, group strings that are identical between</span>
<span class="sd">                    Footprint objects designate them as part of the same</span>
<span class="sd">                    group for plotting, i.e. &quot;Nearby Houses&quot;</span>
<span class="sd">            x - iterable, x coordinates of Footprint</span>
<span class="sd">            y - iterable, y coordinates of Footprint</span>
<span class="sd">            power_line - bool, True indicates the footprint corresponds to</span>
<span class="sd">                         a modeled power line or circuit</span>
<span class="sd">            of_concern - bool, True if the Footprint represents an area</span>
<span class="sd">                         that is potentially concerned about EMF (homes)</span>
<span class="sd">            draw_as_loop - bool, True if the footprint should be plotted</span>
<span class="sd">                           as a closed loop&quot;&quot;&quot;</span>
        <span class="c1">#check x and y are the same length</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Footprints must have the same number of x and y values to form</span>
<span class="s2">            spatial coordinates&quot;&quot;&quot;</span><span class="p">))</span>

        <span class="c1">#init variables</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_power_line</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_of_concern</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_draw_as_loop</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#set attributes</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">power_line</span> <span class="o">=</span> <span class="n">power_line</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">of_concern</span> <span class="o">=</span> <span class="n">of_concern</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">draw_as_loop</span> <span class="o">=</span> <span class="n">draw_as_loop</span>
</pre></div>

                    </div>
                </div></div><div class="properties" id="Footprint-properties"><h4>Properties</h4><div class="property" id="Footprint-draw_as_loop"><p class="property-name">draw_as_loop</p><p class="docstr">bool, flag indicating whether the Footprint should be drawn as a closed loop</p></div><div class="property" id="Footprint-group"><p class="property-name">group</p><p class="docstr">Footprint group</p></div><div class="property" id="Footprint-name"><p class="property-name">name</p><p class="docstr">Footprint name</p></div><div class="property" id="Footprint-of_concern"><p class="property-name">of_concern</p><p class="docstr">bool, flag indicating whether the Footprint is "of concern," which means that the maximum fields along its border will be annoted on plots</p></div><div class="property" id="Footprint-power_line"><p class="property-name">power_line</p><p class="docstr">bool, flag indicating whether the Footprint represents the path of a power line or circuit (1 = yes)</p></div><div class="property" id="Footprint-x"><p class="property-name">x</p><p class="docstr">x coordinates of Footprint vertices</p></div><div class="property" id="Footprint-y"><p class="property-name">y</p><p class="docstr">y coordinates of Footprint vertices</p></div></div></div><div class="class" id="Model"><h3>Model</h3><p class="docstr">Model objects store Tower and/or Conductor objects, information about the desired model grid, and provide the means of computing magnetic fields. Model objects are designed to make it easy to compute the fields over a uniform height 2 dimensional grid. Model objects store x limits, y limits, a z coordinate, and a grid spacing to automatically construct a 2d grid of sample points and calculate magnetic fields at those points. The calculate() method returns a grid of results in the form of a Results object, which can be used to create plots and analyze the grid. Alternatively, an arbitrary set of x, y, z coordinates can be passed to the sample() method to calculate fields at any set of points in 3d space and bypass the Results object entirely.</p><div class="function" ><p class="function-str"><span class="function-name">Model</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;name - string, a name identifying the Model, used for filenames<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;towers - an iterable of Tower objects to include in the Model<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;conductors - an iterable of Conductor objects to include in the Model<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xmin - float, the minimum x value in the Model area, default is zero (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;xmax - float, the maximum x value in the Model area, will use<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   Tower and Conductor information to pick value automatically<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   if left unset and return None if left unset with no Towers or<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   Conductors in the Model<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ymin - float, the minimum y value in the Model area, default is zero (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ymax - float, the maximum y value in the Model area, will use<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   Tower and Conductor information to pick value automatically<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   if left unset and return None if left unset with no Towers or<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   Conductors in the Model<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;z - float, the vertical height to calculate magnetic fields at (ft),<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;defaults to 3.28 ft (the SUBCALC default)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;spacing - float, the spacing between grid points, defaults to 1 (ft)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        kw:</span>
<span class="sd">            name - string, a name identifying the Model, used for filenames</span>
<span class="sd">            towers - an iterable of Tower objects to include in the Model</span>
<span class="sd">            conductors - an iterable of Conductor objects to include in the Model</span>
<span class="sd">            xmin - float, the minimum x value in the Model area, default is zero (ft)</span>
<span class="sd">            xmax - float, the maximum x value in the Model area, will use</span>
<span class="sd">                   Tower and Conductor information to pick value automatically</span>
<span class="sd">                   if left unset and return None if left unset with no Towers or</span>
<span class="sd">                   Conductors in the Model</span>
<span class="sd">            ymin - float, the minimum y value in the Model area, default is zero (ft)</span>
<span class="sd">            ymax - float, the maximum y value in the Model area, will use</span>
<span class="sd">                   Tower and Conductor information to pick value automatically</span>
<span class="sd">                   if left unset and return None if left unset with no Towers or</span>
<span class="sd">                   Conductors in the Model</span>
<span class="sd">            z - float, the vertical height to calculate magnetic fields at (ft),</span>
<span class="sd">                defaults to 3.28 ft (the SUBCALC default)</span>
<span class="sd">            spacing - float, the spacing between grid points, defaults to 1 (ft)&quot;&quot;&quot;</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_towers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_conductors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_xmin</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_xmax</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_ymin</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_ymax</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="mf">3.28</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_spacing</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_N</span> <span class="o">=</span> <span class="mf">1e5</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">_auto_lim_frac</span> <span class="o">=</span> <span class="mf">0.1</span>

        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;towers&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;towers&#39;</span><span class="p">]:</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">add_tower</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;conductors&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;conductors&#39;</span><span class="p">]:</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">add_conductor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;xmax&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;ymax&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;z&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;spacing&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;spacing&#39;</span><span class="p">]</span>
</pre></div>

                    </div>
                </div></div><div class="properties" id="Model-properties"><h4>Properties</h4><div class="property" id="Model-N"><p class="property-name">N</p><p class="docstr">The total number of sample points in the Model. This property can only be set approximately.</p></div><div class="property" id="Model-X"><p class="property-name">X</p><p class="docstr">2D array of x coordinates in the Model Grid</p></div><div class="property" id="Model-Y"><p class="property-name">Y</p><p class="docstr">2D array of y coordinates in the Model Grid</p></div><div class="property" id="Model-auto_lim_frac"><p class="property-name">auto_lim_frac</p><p class="docstr">auto_lim_frac determines how much padding is automatically used between<br>&ensp;&ensp;&ensp;&ensp;the Model domain edges (xmin, xmax, ymin, ymax) and Tower/Conductor<br>&ensp;&ensp;&ensp;&ensp;objects in the Model. To automatically find xmin and xmax, these steps<br>&ensp;&ensp;&ensp;&ensp;are taken:<br>&ensp;&ensp;&ensp;&ensp;   1) find the total range of x coordinates for Tower/Conductor objects<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  in the Model<br>&ensp;&ensp;&ensp;&ensp;   2) compute a padding distance by multiplying the total x range by<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  auto_lim_frac<br>&ensp;&ensp;&ensp;&ensp;   3) compute xmin by taking the minimum x coordinate of Tower/Conductor<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  objects in the Model and subtracting the padding distance<br>&ensp;&ensp;&ensp;&ensp;   4) compute xmax by taking the maximum x coordinate of Tower/Conductor<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  objects in the Model and subtracting the padding distance<br>&ensp;&ensp;&ensp;&ensp;The same steps are taken for the y direction, using the y range instead.</p></div><div class="property" id="Model-conductors"><p class="property-name">conductors</p><p class="docstr">List of Conductor objects in the Model</p></div><div class="property" id="Model-footprints"><p class="property-name">footprints</p><p class="docstr">List of Footprint objects create from Tower and Conductor objects in the Model.</p></div><div class="property" id="Model-name"><p class="property-name">name</p><p class="docstr">A string identifying the Model, used for filenames</p></div><div class="property" id="Model-segments"><p class="property-name">segments</p><p class="docstr">Parse lists of Conductor and Tower objects in the Model into individual wire segments, for emf calculations. A list of tuples is returned, each representing a single wire and containing the wire's start and end points (a and b), the current amplitude, and the phase: ((xa, ya, za), (xb, yb, zb), I, phase)</p></div><div class="property" id="Model-spacing"><p class="property-name">spacing</p><p class="docstr">Spacing between sample points along x and y axes of the Model grid (ft)</p></div><div class="property" id="Model-tower_group_names"><p class="property-name">tower_group_names</p><p class="docstr">Set of unique group strings representing the Towers in Model.towers</p></div><div class="property" id="Model-tower_groups"><p class="property-name">tower_groups</p><p class="docstr">A list of lists of Tower objects with identical group strings, with the sublists sorted according to the Tower seq property</p></div><div class="property" id="Model-towers"><p class="property-name">towers</p><p class="docstr">List of Tower objects in the Model</p></div><div class="property" id="Model-x"><p class="property-name">x</p><p class="docstr">Array of unique x coordinates in the Model grid</p></div><div class="property" id="Model-xlim"><p class="property-name">xlim</p><p class="docstr">The range of x coordinates in the Model: (xmin, xmax)</p></div><div class="property" id="Model-xmax"><p class="property-name">xmax</p><p class="docstr">The maximum x value in the Model area in feet, will use Tower and Conductor information to pick a value automatically if left unset and return None if left unset with no Towers or Conductors in the Model</p></div><div class="property" id="Model-xmin"><p class="property-name">xmin</p><p class="docstr">The minimum x value in the Model area in feet, will use Tower and Conductor information to pick a value automatically if left unset and return None if left unset with no Towers or Conductors in the Model</p></div><div class="property" id="Model-y"><p class="property-name">y</p><p class="docstr">Array of unique y coordinates in the Model grid</p></div><div class="property" id="Model-ylim"><p class="property-name">ylim</p><p class="docstr">The range of y coordinates in the Model: (ymin, ymax)</p></div><div class="property" id="Model-ymax"><p class="property-name">ymax</p><p class="docstr">The maximum y value in the Model area in feet, will use Tower and Conductor information to pick a value automatically if left unset and return None if left unset with no Towers or Conductors in the Model</p></div><div class="property" id="Model-ymin"><p class="property-name">ymin</p><p class="docstr">The minimum y value in the Model area in feet, will use Tower and Conductor information to pick a value automatically if left unset and return None if left unset with no Towers or Conductors in the Model</p></div><div class="property" id="Model-z"><p class="property-name">z</p><p class="docstr">Vertical (z) coordinate to calculate magnetic fields at (ft)</p></div></div><div class="methods" id="Model-methods"><h4>Methods</h4><div class="function" id=Model-add_conductor><p class="function-str"><span class="function-name">add_conductor</span>(<span class="function-arg">c</span>)</p><p class="docstr">Add a Conductor object to the Model<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;c - Conductor object to add (a copy is added)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">add_conductor</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Conductor object to the Model</span>
<span class="sd">        args:</span>
<span class="sd">            c - Conductor object to add (a copy is added)&quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Conductor</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;The add_conductor method of Model objects can only
            add Conductor objects.&#39;</span><span class="p">))</span><span class="n">
</span>        <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">conductors</span><span class="p">]):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Cannot add conductors with identical names. The name
            &quot;</span><span class="si">%s</span><span class="s1">&quot; is already used.&#39;</span> <span class="o">%</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">))</span><span class="n">
</span>        <span class="bp2">self</span><span class="o">.</span><span class="n">_conductors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Model-add_tower><p class="function-str"><span class="function-name">add_tower</span>(<span class="function-arg">tnew</span>)</p><p class="docstr">Add a Tower object to the Model<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tnew - Tower object to add (a copy is added)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">add_tower</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">tnew</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Tower object to the Model</span>
<span class="sd">        args:</span>
<span class="sd">            tnew - Tower object to add (a copy is added)&quot;&quot;&quot;</span>
        <span class="c1">#check type</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tnew</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Tower</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;The add_tower method of Model objects can only add Tower objects.&#39;</span><span class="p">))</span>
        <span class="c1">#check that the Tower&#39;s number of conductors, configuration of currents,</span>
        <span class="c1">#and configuration of phases matches those of conductors in the same</span>
        <span class="c1">#group</span>
        <span class="n">group_names</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">tower_group_names</span>
        <span class="k">if</span><span class="p">(</span><span class="n">tnew</span><span class="o">.</span><span class="n">group</span> <span class="ow">in</span> <span class="n">group_names</span><span class="p">):</span>
            <span class="c1">#collect Towers in the same group</span>
            <span class="n">group</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">towers</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="n">tnew</span><span class="o">.</span><span class="n">group</span><span class="p">)]</span>
            <span class="c1">#get an existing Tower in the same group to compare against</span>
            <span class="n">tcomp</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#check lengths</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tnew</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tcomp</span><span class="p">)):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;All Towers with the same group must have the
                same length. The Tower cannot be added because it has a
                different number of wires than other Towers in the &quot;</span><span class="si">%s</span><span class="s1">&quot; group.&#39;</span><span class="n">
</span>                <span class="o">%</span> <span class="n">tnew</span><span class="o">.</span><span class="n">group</span><span class="p">))</span><span class="n">
</span>            <span class="c1">#check currents</span>
            <span class="k">if</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">tnew</span><span class="o">.</span><span class="n">I</span> <span class="o">!=</span> <span class="n">tcomp</span><span class="o">.</span><span class="n">I</span><span class="p">)):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;All Towers with the same group must have the
                same currents. The Tower cannot be added because it has a
                different current configuration than other Towers in the &quot;</span><span class="si">%s</span><span class="s1">&quot;
                group.&#39;</span> <span class="o">%</span> <span class="n">tnew</span><span class="o">.</span><span class="n">group</span><span class="p">))</span><span class="n">
</span>            <span class="c1">#check phasing</span>
            <span class="k">if</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">tnew</span><span class="o">.</span><span class="n">phase</span> <span class="o">!=</span> <span class="n">tcomp</span><span class="o">.</span><span class="n">phase</span><span class="p">)):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;All Towers with the same group must have the
                same phasing. The Tower cannot be added because it has a
                different phase configuration than other Towers in the &quot;</span><span class="si">%s</span><span class="s1">&quot;
                group.&#39;</span> <span class="o">%</span> <span class="n">tnew</span><span class="o">.</span><span class="n">group</span><span class="p">))</span><span class="n">
</span>            <span class="c1">#check sequencing</span>
            <span class="k">if</span><span class="p">(</span><span class="n">tnew</span><span class="o">.</span><span class="n">seq</span> <span class="ow">in</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">seq</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;All Towers with the same group must have the
                different &quot;seq&quot; numbers. The Tower cannot be added because it
                has the same &quot;seq&quot; as another Tower in the &quot;</span><span class="si">%s</span><span class="s1">&quot; group.&#39;</span> <span class="o">%</span><span class="n">
</span>                <span class="n">tnew</span><span class="o">.</span><span class="n">group</span><span class="p">))</span><span class="n">
</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_towers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tnew</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Model-calculate><p class="function-str"><span class="function-name">calculate</span>(<span class="function-arg">components</span>=<span class="default-str">'all'</span>, <span class="function-arg">footprints</span>=<span class="function-arg">None</span>, <span class="function-arg">clear</span>=<span class="function-arg">False</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Parse the Tower and Conductor objects into individual wire segements and compute the magnetic fields produced by the collection of wire segments in the model domain, returning a Results object. The Tower and Conductor objects will also be converted to Footprint objects in the newly created Results object.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;components - list of components of the field to be included in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; the returned Results object. Can be any combination<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; of 'Bmax', 'Bres', 'Bx', 'By', 'Bz' or it can be<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; 'all' to store all of those options. The default is<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; 'all'. Choosing fewer components will not speed up<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; calculations, but it will reduce memory demand. The<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; components chosen will become the available 'Bkeys'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; in the returned Results object.<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;footprints - string, path to the footprint csv/excel data.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;If footprint data is in an excel workbook with<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;multiple sheets, the sheet name must be passed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;to the kwarg 'sheet'<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;or<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;an existing DataFrame with footprint data<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;clear - bool, if False, loaded Footprints will be appended to the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;list of Footprints created from Tower and Conductor objects.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;The default is False. If True, only the loaded Footprints<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;are used.<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - str, specifies the target sheet if an excel workbook with<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;multiple sheets is passed in to the footprints arg<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;(not needed for a csv or an excel book with 1 sheet)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;res - a Results object</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">footprints</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse the Tower and Conductor objects into individual wire segements
        and compute the magnetic fields produced by the collection of wire
        segments in the model domain, returning a Results object. The Tower and
        Conductor objects will also be converted to Footprint objects in the
        newly created Results object.
        optional args:</span>

<span class="sd">            components - list of components of the field to be included in</span>
<span class="sd">                         the returned Results object. Can be any combination</span>
<span class="sd">                         of &#39;Bmax&#39;, &#39;Bres&#39;, &#39;Bx&#39;, &#39;By&#39;, &#39;Bz&#39; or it can be</span>
<span class="sd">                         &#39;all&#39; to store all of those options. The default is</span>
<span class="sd">                         &#39;all&#39;. Choosing fewer components will not speed up</span>
<span class="sd">                         calculations, but it will reduce memory demand. The</span>
<span class="sd">                         components chosen will become the available &#39;Bkeys&#39;</span>
<span class="sd">                         in the returned Results object.</span>

<span class="sd">            footprints - string, path to the footprint csv/excel data.</span>
<span class="sd">                        If footprint data is in an excel workbook with</span>
<span class="sd">                        multiple sheets, the sheet name must be passed</span>
<span class="sd">                        to the kwarg &#39;sheet&#39;</span>

<span class="sd">                            or</span>

<span class="sd">                        an existing DataFrame with footprint data</span>

<span class="sd">            clear - bool, if False, loaded Footprints will be appended to the</span>
<span class="sd">                    list of Footprints created from Tower and Conductor objects.</span>
<span class="sd">                    The default is False. If True, only the loaded Footprints</span>
<span class="sd">                    are used.</span>

<span class="sd">        kw:</span>
<span class="sd">            sheet - str, specifies the target sheet if an excel workbook with</span>
<span class="sd">                    multiple sheets is passed in to the footprints arg</span>
<span class="sd">                    (not needed for a csv or an excel book with 1 sheet)</span>
<span class="sd">        returns:</span>
<span class="sd">            res - a Results object&quot;&quot;&quot;</span>
        <span class="c1">#check properties</span>
        <span class="k">if</span><span class="p">((</span><span class="ow">not</span> <span class="bp2">self</span><span class="o">.</span><span class="n">conductors</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp2">self</span><span class="o">.</span><span class="n">towers</span><span class="p">)):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Cannot calculate fields because there are no Tower
            or Conductor objects in the Model. All fields would be zero.&#39;</span><span class="p">))</span><span class="n">
</span>        <span class="c1">#get components</span>
        <span class="n">all_components</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bmax&#39;</span><span class="p">,</span> <span class="s1">&#39;Bres&#39;</span><span class="p">,</span> <span class="s1">&#39;Bx&#39;</span><span class="p">,</span> <span class="s1">&#39;By&#39;</span><span class="p">,</span> <span class="s1">&#39;Bz&#39;</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="n">components</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">all_components</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_components</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;The only valid components are &#39;Bmax&#39;,
                    &#39;Bres&#39;, &#39;Bx&#39;, &#39;By&#39;, and &#39;Bz&#39;. The input component </span><span class="si">%s</span><span class="s2"> is not
                    valid.&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span><span class="n">
</span>        <span class="c1">#start time</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="c1">#get wire segments</span>
        <span class="n">S</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">segments</span>
        <span class="c1">#get sample points</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="bp2">self</span><span class="o">.</span><span class="n">z</span>
        <span class="n">x_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">y_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">z_sample</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="c1">#compute one set of phasors to get arrays started</span>
        <span class="n">Ph_x</span><span class="p">,</span> <span class="n">Ph_y</span><span class="p">,</span> <span class="n">Ph_z</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">B_field_segment</span><span class="p">(</span>
                <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">,</span> <span class="n">z_sample</span><span class="p">)</span>
        <span class="c1">#updates</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;wire segments complete: 1/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)),</span>
        <span class="c1">#compute the fields of all other segments and add the phasors</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)):</span>
            <span class="n">Ph</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">B_field_segment</span><span class="p">(</span>
                    <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">,</span> <span class="n">z_sample</span><span class="p">)</span>
            <span class="n">Ph_x</span> <span class="o">+=</span> <span class="n">Ph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Ph_y</span> <span class="o">+=</span> <span class="n">Ph</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Ph_z</span> <span class="o">+=</span> <span class="n">Ph</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">wire segments complete: </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">))),</span>
        <span class="c1">#convert the results into a 2D grid</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">wire segments complete. computing magnitudes from phasors.&#39;</span><span class="p">),</span>
        <span class="n">Ph_x</span><span class="p">,</span><span class="n">Ph_y</span><span class="p">,</span><span class="n">Ph_z</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">grid_segment_results</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span><span class="n">Ph_y</span><span class="p">,</span><span class="n">Ph_z</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="c1">#get the real components</span>
        <span class="n">Bx</span><span class="p">,</span><span class="n">By</span><span class="p">,</span><span class="n">Bz</span><span class="p">,</span><span class="n">Bres</span><span class="p">,</span><span class="n">Bmax</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">phasors_to_magnitudes</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span><span class="n">Ph_y</span><span class="p">,</span><span class="n">Ph_z</span><span class="p">)</span>
        <span class="c1">#create a Results object with info about the original calculations</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
            <span class="k">exec</span><span class="p">(</span><span class="s2">&quot;data[&#39;</span><span class="si">%s</span><span class="s2">&#39;] = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Created on&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()),</span>
                <span class="s1">&#39;Z Height (ft)&#39;</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span>
                <span class="s1">&#39;Minimum X Coordinate&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                <span class="s1">&#39;Minimum Y Coordinate&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="s1">&#39;Maximum X Coordinate&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                <span class="s1">&#39;Maximum Y Coordinate&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="s1">&#39;X Grid Increment&#39;</span><span class="p">:</span> <span class="bp2">self</span><span class="o">.</span><span class="n">spacing</span><span class="p">,</span>
                <span class="s1">&#39;Y Grid Increment&#39;</span><span class="p">:</span> <span class="bp2">self</span><span class="o">.</span><span class="n">spacing</span><span class="p">,</span>
                <span class="s1">&#39;Number X Grid Points&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                <span class="s1">&#39;Number Y Grid Points&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="s1">&#39;Total Grid Points&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="s1">&#39;Distance Units&#39;</span><span class="p">:</span> <span class="s1">&#39;feet&#39;</span><span class="p">,</span>
                <span class="s1">&#39;B-Field Units&#39;</span><span class="p">:</span> <span class="s1">&#39;mG&#39;</span><span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">Results</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
        <span class="c1">#load Footprints</span>
        <span class="k">if</span><span class="p">(</span><span class="n">footprints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">clear</span><span class="p">):</span>
                <span class="n">res</span><span class="o">.</span><span class="n">load_footprints</span><span class="p">(</span><span class="n">footprints</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">_footprints</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">footprints</span>
                <span class="n">res</span><span class="o">.</span><span class="n">load_footprints</span><span class="p">(</span><span class="n">footprints</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_footprints</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">footprints</span>
        <span class="c1">#copy the name over if it has been set</span>
        <span class="k">if</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">_name</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">name</span>
        <span class="c1">#print elapsed time</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">all calculations complete. total calculation time: </span><span class="si">%g</span><span class="s1"> seconds.&#39;</span> <span class="o">%</span>
                <span class="p">(</span><span class="n">t_end</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
        <span class="c1">#return</span>
        <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Model-clear_towers><p class="function-str"><span class="function-name">clear_towers</span>()</p><p class="docstr">Remove all Conductor objects from the Model's list of conductors.</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">clear_towers</span><span class="p">(</span><span class="bp2">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove all Conductor objects from the Model&#39;s list of conductors.&quot;&quot;&quot;</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_conductors</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Model-load_towers><p class="function-str"><span class="function-name">load_towers</span>(<span class="function-arg">fn</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Read a subcalc tower template and create a new list of Tower objects, adding each of the new towers to the Model's existing list of Towers.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fn - string, the path string to the subcalc tower template file (excel or csv)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - string, if the template file is an excel workbook with multiple sheets,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the target sheet must be specified</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">load_towers</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a subcalc tower template and create a new list of Tower objects,
        adding each of the new towers to the Model&#39;s existing list of Towers.
        args:</span>
<span class="sd">            fn - string, the path string to the subcalc tower template file (excel or csv)</span>
<span class="sd">        kw:</span>
<span class="sd">            sheet - string, if the template file is an excel workbook with multiple sheets,</span>
<span class="sd">                    the target sheet must be specified&quot;&quot;&quot;</span>
        <span class="c1">#use the funks function</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">load_towers</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">return_model</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">add_tower</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Model-sample><p class="function-str"><span class="function-name">sample</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Parse the Tower and Conductor objects into individual wire segements and compute the magnetic fields produced by the collection of wire segments at an arbitrary set of points in 3d space, defined by the x, y, and z inputs.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x* - iterable of numbers or a single number, the x coordinate(s)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of the sample point(s)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y* - iterable of numbers or a single number, the y coordinate(s)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of the sample point(s)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;z* - iterable of numbers or a single number, the z coordinate(s)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of the sample point(s). If omitted, the Model objects "z"<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;property is used and the returned dataframe is only indexed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;by the input x and y coordinates.<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;*if any of these inputs are iterables, they must have the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;same length as other iterable inputs.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;n - integer, if provided, the input coordinates will be treated<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;as a path and new points will be generated along it with<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;linear interpolation to achieve a total number of points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;close to "n"<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;df - pandas DataFrame containing all components of the computed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; fields, the sampled coordinates, and the cumulative distance<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; along the sampling path. The samples form a MultiIndex in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; the returned DataFrame, which allows the data frame to be<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; indexed by sampled points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;e.g. df[x,y,z] or df[x,y]</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse the Tower and Conductor objects into individual wire segements
        and compute the magnetic fields produced by the collection of wire
        segments at an arbitrary set of points in 3d space, defined by the x, y,
        and z inputs.
        args:</span>
<span class="sd">            x* - iterable of numbers or a single number, the x coordinate(s)</span>
<span class="sd">                of the sample point(s)</span>
<span class="sd">            y* - iterable of numbers or a single number, the y coordinate(s)</span>
<span class="sd">                of the sample point(s)</span>
<span class="sd">        optional args:</span>
<span class="sd">            z* - iterable of numbers or a single number, the z coordinate(s)</span>
<span class="sd">                of the sample point(s). If omitted, the Model objects &quot;z&quot;</span>
<span class="sd">                property is used and the returned dataframe is only indexed</span>
<span class="sd">                by the input x and y coordinates.</span>

<span class="sd">                *if any of these inputs are iterables, they must have the</span>
<span class="sd">                    same length as other iterable inputs.</span>
<span class="sd">        kw:</span>
<span class="sd">            n - integer, if provided, the input coordinates will be treated</span>
<span class="sd">                as a path and new points will be generated along it with</span>
<span class="sd">                linear interpolation to achieve a total number of points</span>
<span class="sd">                close to &quot;n&quot;</span>
<span class="sd">        returns:</span>
<span class="sd">            df - pandas DataFrame containing all components of the computed</span>
<span class="sd">                 fields, the sampled coordinates, and the cumulative distance</span>
<span class="sd">                 along the sampling path. The samples form a MultiIndex in</span>
<span class="sd">                 the returned DataFrame, which allows the data frame to be</span>
<span class="sd">                 indexed by sampled points</span>
<span class="sd">                    e.g. df[x,y,z] or df[x,y]&quot;&quot;&quot;</span>

        <span class="c1">#start time</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="c1">#check for z input</span>
        <span class="n">noz</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
            <span class="n">noz</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Model.sample() accepts two or three arguments only.
            They are the x, y, and z coordinates to sample and each can be a
            single number or an iterable of numbers. Iterables passed in must
            have the same length, and single numbers passed in are used for all
            sampled points.&#39;</span><span class="p">))</span><span class="n">
</span>        <span class="c1">#deal with lengths and make sure to work with np arrays</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_check_to_array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">args</span><span class="p">])</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)):</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])]</span><span class="o">*</span><span class="n">L</span><span class="p">)</span>
                <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">L</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Cannot parse inputs if multiple inputs are
                    iterables (vectors) and they have different lenghts. Inputs
                    must be numbers or iterables with the same length as other
                    iterable inputs.&quot;</span><span class="p">))</span><span class="n">
</span>            <span class="c1">#check for interpolation</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;n&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_interp_path_3D</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1">#get wire segments</span>
        <span class="n">S</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">segments</span>
        <span class="c1">#compute one set of phasors to get arrays started</span>
        <span class="n">Ph_x</span><span class="p">,</span> <span class="n">Ph_y</span><span class="p">,</span> <span class="n">Ph_z</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">B_field_segment</span><span class="p">(</span>
                <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="c1">#updates</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;wire segments complete: 1/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)),</span>
        <span class="c1">#compute the fields of all other segments and add the phasors</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)):</span>
            <span class="n">Ph</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">B_field_segment</span><span class="p">(</span>
                    <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
            <span class="n">Ph_x</span> <span class="o">+=</span> <span class="n">Ph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Ph_y</span> <span class="o">+=</span> <span class="n">Ph</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Ph_z</span> <span class="o">+=</span> <span class="n">Ph</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">wire segments complete: </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">))),</span>
        <span class="c1">#get the real components</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">wire segments complete. computing magnitudes from phasors.&#39;</span><span class="p">),</span>
        <span class="n">Bx</span><span class="p">,</span><span class="n">By</span><span class="p">,</span><span class="n">Bz</span><span class="p">,</span><span class="n">Bres</span><span class="p">,</span><span class="n">Bmax</span> <span class="o">=</span> <span class="n">subcalc_calcs</span><span class="o">.</span><span class="n">phasors_to_magnitudes</span><span class="p">(</span><span class="n">Ph_x</span><span class="p">,</span><span class="n">Ph_y</span><span class="p">,</span><span class="n">Ph_z</span><span class="p">)</span>
        <span class="c1">#create a dataframe</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">cumulative_distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Bmax</span><span class="o">=</span><span class="n">Bmax</span><span class="p">,</span> <span class="n">Bres</span><span class="o">=</span><span class="n">Bres</span><span class="p">,</span> <span class="n">Bx</span><span class="o">=</span><span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="o">=</span><span class="n">By</span><span class="p">,</span> <span class="n">Bz</span><span class="o">=</span><span class="n">Bz</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">noz</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="c1">#print elapsed time</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">all calculations complete. total calculation time: </span><span class="si">%g</span><span class="s1"> seconds.&#39;</span> <span class="o">%</span>
                <span class="p">(</span><span class="n">t_end</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
        <span class="c1">#return</span>
        <span class="k">return</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Model-to_tower_template><p class="function-str"><span class="function-name">to_tower_template</span>(<span class="function-arg">fmt</span>=<span class="default-str">'csv'</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Export the Towers in the Model object to a template file in csv or excel format. Any Conductor objects in the Model will NOT be written to the tower template.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;fmt - 'csv' or 'excel'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, output destination/filename</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">to_tower_template</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Export the Towers in the Model object to a template file in csv or
        excel format. Any Conductor objects in the Model will NOT be written to
        the tower template.
        optional args:</span>
<span class="sd">            fmt - &#39;csv&#39; or &#39;excel&#39;</span>
<span class="sd">        kw:</span>
<span class="sd">            path - string, output destination/filename&quot;&quot;&quot;</span>
        <span class="c1">#get filename</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.csv&#39;</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;excel&#39;</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.xlsx&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;fmt argument must be &#39;csv&#39; or &#39;excel&#39;.&quot;</span><span class="p">))</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_path_manage</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;-towers&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="c1">#compile template dataframe</span>
        <span class="n">L</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">towers</span><span class="p">])</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;sequence&#39;</span><span class="p">,</span> <span class="s1">&#39;tower x&#39;</span><span class="p">,</span> <span class="s1">&#39;tower y&#39;</span><span class="p">,</span> <span class="s1">&#39;rotation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">towers</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">group</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">seq</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tower_x</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">tower_y</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rot</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="n">cols</span><span class="p">[</span><span class="mi">8</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;towers in model &quot;</span><span class="si">%s</span><span class="s1">&quot; written to: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fn</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div></div></div><div class="class" id="Results"><h3>Results</h3><p class="docstr">Results objects store the results of magnetic field modeling generated by the SubCalc program. A Results can be created by passing grid results directly or by passing a dictionary of grid results. The function subcalc.load_results is the best way to generate a Results object from a .REF file containing SubCalc results. The Results object can be saved to a more flexible (and smaller) excel file with Results.export(). Then the excel file can be read back into a Results object using subcalc.load_results.<br><br>&ensp;&ensp;&ensp;&ensp;Results objects have a 'Bkey' property that determines which component of the magnetic field results is accessed by the Results.B property. For example, when Results.Bkey == 'Bmax' all operations involving the grid of magnetic field results accessed by Results.B will operate on the 'max' field component. When Bmax == 'Bz' all operations deal with the vertical 'z' component of the field, and so on. This includes plotting.<br><br>&ensp;&ensp;&ensp;&ensp;Footprints of objects in the Results domain like buildings, the power lines, fences, etc. can also be stored in Results objects. Data for these objects can be saved in csv template files. The path of the footprint csv files can be passed to subcalc.load_results() for automatic inclusion in a newly generated Results object or it can be passed to an existing Results with Results.load_footprints(). The footprint data is stored in Footprint objects that have very little functionality and are mostly just organizational objects.<br><br>&ensp;&ensp;&ensp;&ensp;Several methods are available for interpolating new values from the grid of field results: Results.interp(), Results.segment(), Results.path(), and Results.resample().<br><br>&ensp;&ensp;&ensp;&ensp;There are also methods for selecting a subset of a Results object's domain and for shifting its x,y coordinates. These are Results.zoom() and Results.rereference() respectively.<br><br>&ensp;&ensp;&ensp;&ensp;Contour plots of the fields (Results.B) can be automatically generated with subcalc.plot_contour() and colormesh plots can be automatically generated with subcalc.plot_pcolormesh(), both of which accept Results objects. The fields along a path through the Results domain (essentially a cross section) can be plotted with subcalc.plot_path. A contour or pcolormesh can be combined with cross sections using the subcalc.plot_cross_sections() function.</p><div class="function" ><p class="function-str"><span class="function-name">Results</span>(*<span class="function-arg">args</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Grid data must be passed in<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;either:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;X - 2D array of x coordinates<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Y - 2D array of y coordinats<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B - 2D array of magnetic field magnitudes<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;info - dict, optional, dictionary of results metadata<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;or:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;data - dict, dictionary with X, Y, and B grids, should be<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;keyed by 'X','Y','Bmax','Bres','Bx','By','Bz'<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;info - dict, optional, dictionary of results metadata<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;name - str, name for the object, used for filenames and such<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Bkey - str, selects which component of field results to use<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;or defines which component is passed as grid arrays<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;('Bmax', 'Bres', 'Bx', 'By', 'Bz').</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Grid data must be passed in</span>
<span class="sd">        args:</span>
<span class="sd">            either:</span>
<span class="sd">                X - 2D array of x coordinates</span>
<span class="sd">                Y - 2D array of y coordinats</span>
<span class="sd">                B - 2D array of magnetic field magnitudes</span>
<span class="sd">                info - dict, optional, dictionary of results metadata</span>
<span class="sd">            or:</span>
<span class="sd">                data - dict, dictionary with X, Y, and B grids, should be</span>
<span class="sd">                            keyed by &#39;X&#39;,&#39;Y&#39;,&#39;Bmax&#39;,&#39;Bres&#39;,&#39;Bx&#39;,&#39;By&#39;,&#39;Bz&#39;</span>
<span class="sd">                info - dict, optional, dictionary of results metadata</span>
<span class="sd">        kw:</span>
<span class="sd">            name - str, name for the object, used for filenames and such</span>
<span class="sd">            Bkey - str, selects which component of field results to use</span>
<span class="sd">                    or defines which component is passed as grid arrays</span>
<span class="sd">                    (&#39;Bmax&#39;, &#39;Bres&#39;, &#39;Bx&#39;, &#39;By&#39;, &#39;Bz&#39;).&quot;&quot;&quot;</span>

        <span class="n">largs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="c1">#inputs must correspond to the second case, dictionary of data and</span>
        <span class="c1">#optional dict of metadata</span>
        <span class="k">if</span><span class="p">(</span><span class="n">largs</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="c1">#check args[0]</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The first argument to Results() must be a
                dictionary of result information when passing 1 or 2 arguments
                to initialize the Results, not </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span><span class="n">
</span>            <span class="c1">#check keys</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Bmax&#39;</span><span class="p">,</span> <span class="s1">&#39;Bres&#39;</span><span class="p">,</span> <span class="s1">&#39;Bx&#39;</span><span class="p">,</span> <span class="s1">&#39;By&#39;</span><span class="p">,</span> <span class="s1">&#39;Bz&#39;</span><span class="p">])</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">any</span><span class="p">([(</span><span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">])):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;If passing a dictionary to initialize a
                Results object, the dict can have the following keys only:
                    </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
            <span class="k">if</span><span class="p">((</span><span class="s1">&#39;X&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="p">)):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;If passing a dictionary to initialize a
                Results object, the dictionary must have &#39;X&#39; and &#39;Y&#39; keys, which
                lead to grid coordinate arrays.&quot;&quot;&quot;</span><span class="p">))</span><span class="n">
</span>            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;If passing a dictionary to initialize a
                Results object, the dictionary must be keyed by &#39;X&#39;, &#39;Y&#39;, and
                any number of the following keys:
                    </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">([</span><span class="s1">&#39;Bmax&#39;</span><span class="p">,</span><span class="s1">&#39;Bres&#39;</span><span class="p">,</span><span class="s1">&#39;Bx&#39;</span><span class="p">,</span><span class="s1">&#39;By&#39;</span><span class="p">,</span><span class="s1">&#39;Bz&#39;</span><span class="p">])))</span>
            <span class="c1">#store data</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#deal with Bkey</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;Bkey&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">Bkey</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;Bkey&#39;</span><span class="p">]</span>
            <span class="k">elif</span><span class="p">(</span><span class="s1">&#39;Bmax&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">):</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">Bkey</span> <span class="o">=</span> <span class="s1">&#39;Bmax&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">k</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">k</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
                <span class="n">k</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">Bkey</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#store the info dict if present</span>
            <span class="k">if</span><span class="p">(</span><span class="n">largs</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The fourth argument to Results() must be a
                    dictionary of  results information, not </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span><span class="n">
</span>                    <span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span><span class="n">
</span>                <span class="bp2">self</span><span class="o">.</span><span class="n">_info</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">_info</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1">#inputs must correspond to the first case, grids passed in directly</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">largs</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">):</span>
            <span class="c1">#check input types</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;If passing three or four arguments to initialize a Results,
            the first three arguments must be 2D numpy arrays representing X, Y,
            and B grids respectively, each with the same shape.&quot;&quot;&quot;</span><span class="n">
</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
                <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
                <span class="k">elif</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
            <span class="c1">#2D reference grid arrays</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;Bkey&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">_Bkey</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;Bkey&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">_Bkey</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp2">self</span><span class="o">.</span><span class="n">_Bkey</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
            <span class="c1">#store the info dict if present</span>
            <span class="k">if</span><span class="p">(</span><span class="n">largs</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The fourth argument to Results() must be a
                    dictionary of results information, not type </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span><span class="n">
</span>                    <span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span><span class="n">
</span>                <span class="bp2">self</span><span class="o">.</span><span class="n">_info</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp2">self</span><span class="o">.</span><span class="n">_info</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#other reference objects in the results domain, like substatio</span>
        <span class="c1">#boundaries, stored in a list of Footprint objects</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_footprints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#angle of the northern direction with respect to the grid</span>
        <span class="c1">#   where 0 degrees is the positive y axis and clockwise is increasing</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_north_angle</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#private list of column names for parsing and creating footprint dfs</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_footprint_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Power Line?&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Of Concern?&#39;</span><span class="p">,</span> <span class="s1">&#39;Draw as Loop?&#39;</span><span class="p">]</span>
</pre></div>

                    </div>
                </div></div><div class="properties" id="Results-properties"><h4>Properties</h4><div class="property" id="Results-B"><p class="property-name">B</p><p class="docstr">2D grid of magnetic field results with y-coordinates decreasing down the rows and x-coordinates inreasing along the columns. For example, B[0,0] retrieves the result at the lowest x value and highest y value and B[-1,-1] retrieves the result at the higest x value and lowest y value. The grid is arranged so that the coordinate arrays print in the same way they are arranged on a cartesian plane.</p></div><div class="property" id="Results-Bkey"><p class="property-name">Bkey</p><p class="docstr">Component of magnetic field accessed by the B property</p></div><div class="property" id="Results-Bkeys"><p class="property-name">Bkeys</p><p class="docstr">A set of available Bkey values in the Results</p></div><div class="property" id="Results-Bmax"><p class="property-name">Bmax</p><p class="docstr">Maximum value of Results.B</p></div><div class="property" id="Results-Bmin"><p class="property-name">Bmin</p><p class="docstr">Minimum value of Results.B</p></div><div class="property" id="Results-N"><p class="property-name">N</p><p class="docstr">The total number of sample points in the Results grid</p></div><div class="property" id="Results-X"><p class="property-name">X</p><p class="docstr">2D grid of reference grid x coordinates</p></div><div class="property" id="Results-Y"><p class="property-name">Y</p><p class="docstr">2D grid of reference grid y coordinates</p></div><div class="property" id="Results-footprint_df"><p class="property-name">footprint_df</p><p class="docstr">A DataFrame of Footprint information in the same format as the emf.subcalc footprint template</p></div><div class="property" id="Results-footprint_group_names"><p class="property-name">footprint_group_names</p><p class="docstr">A set of the unique footprint group names in the Results object</p></div><div class="property" id="Results-footprint_groups"><p class="property-name">footprint_groups</p><p class="docstr">Generate a list of lists of Footprints with identical tags</p></div><div class="property" id="Results-footprints"><p class="property-name">footprints</p><p class="docstr">List of Footprint objects</p></div><div class="property" id="Results-idx_Bmax"><p class="property-name">idx_Bmax</p><p class="docstr">indices of maximum of Results.B, along the 0th axis then the 1st axis</p></div><div class="property" id="Results-info"><p class="property-name">info</p><p class="docstr">Dictionary of results metadata</p></div><div class="property" id="Results-loc_Bmax"><p class="property-name">loc_Bmax</p><p class="docstr">x,y coordinates of maximum of Results.B</p></div><div class="property" id="Results-name"><p class="property-name">name</p><p class="docstr">Name of results object, used for filenames when exporting</p></div><div class="property" id="Results-north_angle"><p class="property-name">north_angle</p><p class="docstr">Angle of the Northern direction in degrees, where 0 represents the vertical or Y direction and clockwise represents increasing angle</p></div><div class="property" id="Results-spacing"><p class="property-name">spacing</p><p class="docstr">Distance between grid points along the x and y axes (ft). If the spacing is different along the axes, a tuple of two floats is returned. Otherwise only a single float is returned. If the spacing along an axis is non-uniform (can be done with resampling), a string is returned.</p></div><div class="property" id="Results-x"><p class="property-name">x</p><p class="docstr">Unique x values in results grid (column positions)</p></div><div class="property" id="Results-xlim"><p class="property-name">xlim</p><p class="docstr">(xmin, xmax)</p></div><div class="property" id="Results-xmax"><p class="property-name">xmax</p><p class="docstr">Maximum horizontal coordinate in results</p></div><div class="property" id="Results-xmin"><p class="property-name">xmin</p><p class="docstr">Minimum horizontal coordinate in results</p></div><div class="property" id="Results-y"><p class="property-name">y</p><p class="docstr">Unique y values in results grid (row positions)</p></div><div class="property" id="Results-ylim"><p class="property-name">ylim</p><p class="docstr">(ymin, ymax)</p></div><div class="property" id="Results-ymax"><p class="property-name">ymax</p><p class="docstr">Maximum vertical coordinate in results</p></div><div class="property" id="Results-ymin"><p class="property-name">ymin</p><p class="docstr">Minimum vertical coordinate in results</p></div></div><div class="methods" id="Results-methods"><h4>Methods</h4><div class="function" id=Results-concern_points><p class="function-str"><span class="function-name">concern_points</span>(<span class="function-arg">n</span>=<span class="function-arg">101</span>)</p><p class="docstr">Find the maximum fields at all footprint objects in the Results with<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;their "of_concern" properties set to True.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;n - int, number of samples to interpolate along each footprint<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_concern - array, x coordinates of the concern points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y_concern - array, y coordinates of the concern points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B_concern - array, the magnetic field magnitudes at the points</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">concern_points</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the maximum fields at all footprint objects in the Results with</span>
<span class="sd">        their &quot;of_concern&quot; properties set to True.</span>
<span class="sd">        optional args:</span>
<span class="sd">            n - int, number of samples to interpolate along each footprint</span>
<span class="sd">        returns:</span>
<span class="sd">            x_concern - array, x coordinates of the concern points</span>
<span class="sd">            y_concern - array, y coordinates of the concern points</span>
<span class="sd">            B_concern - array, the magnetic field magnitudes at the points&quot;&quot;&quot;</span>
        <span class="c1">#get footprints of concern</span>
        <span class="n">fps</span> <span class="o">=</span> <span class="p">[</span><span class="n">fp</span> <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">footprints</span> <span class="k">if</span> <span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">of_concern</span><span class="p">)]</span>
        <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
        <span class="c1">#find the maximum field along each footprints path</span>
        <span class="n">x_concern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">L</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">y_concern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">L</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">B_concern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">L</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">fps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">fp</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
            <span class="n">x_concern</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_concern</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">B_concern</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x_concern</span><span class="p">,</span> <span class="n">y_concern</span><span class="p">,</span> <span class="n">B_concern</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-copy><p class="function-str"><span class="function-name">copy</span>()</p><p class="docstr">Return a deep copy of the Results object</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp2">self</span><span class="p">):</span>
        <span class="s1">&#39;Return a deep copy of the Results object&#39;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp2">self</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-export><p class="function-str"><span class="function-name">export</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">Export the grid data and accompanying info to an excel file with tabs for each Bfield component, another for the info dict, and a final one for footprints if they're present<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Bkeys - iterable of strings, selects which components to export.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;path - string, output destination/filename for workbook</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Export the grid data and accompanying info to an excel file with tabs
        for each Bfield component, another for the info dict, and a final one
        for footprints if they&#39;re present
        kw:</span>
<span class="sd">            Bkeys - iterable of strings, selects which components to export.</span>
<span class="sd">            path - string, output destination/filename for workbook&quot;&quot;&quot;</span>
        <span class="c1">#get appropriate export filename</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_path_manage</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="c1">#get components to export</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;Bkeys&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="n">Bkeys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;Bkeys&#39;</span><span class="p">])</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">Bkeys</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">Bkeys</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;The only acceptable Bkeys are </span><span class="si">%s</span><span class="s1">. The input
                    &quot;</span><span class="si">%s</span><span class="s1">&quot; is not valid.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_print_str_list</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">k</span><span class="p">)))</span><span class="n">
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="n">Bkeys</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">Bkeys</span>
        <span class="c1">#create excel writing object</span>
        <span class="n">xl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>
        <span class="c1">#write grid data</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
            <span class="k">if</span><span class="p">((</span><span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">Bkeys</span><span class="p">)):</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="bp2">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp2">self</span><span class="o">.</span><span class="n">y</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
        <span class="c1">#write metadata if present</span>
        <span class="k">if</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">info</span><span class="p">):</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="bp2">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp2">self</span><span class="o">.</span><span class="n">info</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="bp2">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span>
                            <span class="n">xl</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;Parameter Name&#39;</span><span class="p">)</span>
        <span class="c1">#write footprints if present</span>
        <span class="k">if</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">footprints</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">footprint_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;footprints&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="bp2">self</span><span class="o">.</span><span class="n">_footprint_cols</span><span class="p">)</span>
        <span class="c1">#save and print</span>
        <span class="n">xl</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;results saved to: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fn</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-flatten><p class="function-str"><span class="function-name">flatten</span>()</p><p class="docstr">Create 1 dimensional versions of the gridded X, Y, and B arrays<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - 1D numpy array with x coordinates<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - 1D numpy array with y coordinates<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;b - 1D numpy array with magnetic field values</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp2">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create 1 dimensional versions of the gridded X, Y, and B arrays</span>
<span class="sd">        returns:</span>
<span class="sd">            x - 1D numpy array with x coordinates</span>
<span class="sd">            y - 1D numpy array with y coordinates</span>
<span class="sd">            b - 1D numpy array with magnetic field values&quot;&quot;&quot;</span>
        <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-in_grid><p class="function-str"><span class="function-name">in_grid</span>(<span class="function-arg">x</span>, <span class="function-arg">y</span>)</p><p class="docstr">Check if an x,y coordinate pair is inside the Results grid<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - float, x coordinate<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - float, y coordinate<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;b - bool, True if x,y is in the grid, False if it's not</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">in_grid</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if an x,y coordinate pair is inside the Results grid</span>
<span class="sd">        args:</span>
<span class="sd">            x - float, x coordinate</span>
<span class="sd">            y - float, y coordinate</span>
<span class="sd">        returns:</span>
<span class="sd">            b - bool, True if x,y is in the grid, False if it&#39;s not&quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;</span> <span class="bp2">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp2">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">)):</span>
            <span class="k">return</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-interp><p class="function-str"><span class="function-name">interp</span>(<span class="function-arg">x</span>, <span class="function-arg">y</span>)</p><p class="docstr">Use bilinear interpolation to estimate the magnetic field at a given x,y location.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - iterable or scalar, x coordinate(s) to interpolate at<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - iterable or scalar, y coordinate(s) to interpolate at<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B_interp - array or float, the interpolated field value</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">interp</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use bilinear interpolation to estimate the magnetic field at a given x,y location.</span>
<span class="sd">        args:</span>
<span class="sd">            x - iterable or scalar, x coordinate(s) to interpolate at</span>
<span class="sd">            y - iterable or scalar, y coordinate(s) to interpolate at</span>
<span class="sd">        returns:</span>
<span class="sd">            B_interp - array or float, the interpolated field value&quot;&quot;&quot;</span>
        <span class="c1">#make x,y iterable if scalars are passed in</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">))):</span>
            <span class="n">scalar</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scalar</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1">#check that all points are in the grid</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="bp2">self</span><span class="o">.</span><span class="n">in_grid</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            x,y coordinates must fall inside the reference grid:</span>
<span class="s2">                range of x coordinates: </span><span class="si">%g</span><span class="s2"> to </span><span class="si">%g</span><span class="s2"></span>
<span class="s2">                range of y coordinates: </span><span class="si">%g</span><span class="s2"> to </span><span class="si">%g</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span>
                <span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">)))</span>
        <span class="c1">#interpolate</span>
        <span class="n">B_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_bilinear_interp</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span>
        <span class="c1">#return</span>
        <span class="k">if</span><span class="p">(</span><span class="n">scalar</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">B_interp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">B_interp</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-load_footprints><p class="function-str"><span class="function-name">load_footprints</span>(<span class="function-arg">footprints</span>, <span class="function-arg">clear</span>=<span class="function-arg">True</span>, **<span class="function-arg">kw</span>)</p><p class="docstr">Read footprint data from a csv/excel file and organize it in Footprint objects stored in self.footprints<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;footprints - string, path to the footprint csv/excel data.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;If footprint data is in an excel workbook with,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;multiple sheets, the sheet name must be passed<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;to the keyword argumment 'sheet'<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;or<br><br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;an existing DataFrame with footprint data<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;clear - bool, True will replace all existing footprints with the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;loaded ones, False will simply add loaded footprints to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;the list of existing ones.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;sheet - str, specifies the target sheet if an excel workbook with<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;multiple sheets is passed in</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">load_footprints</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">footprints</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read footprint data from a csv/excel file and organize it in
        Footprint objects stored in self.footprints
        args:</span>
<span class="sd">            footprints - string, path to the footprint csv/excel data.</span>
<span class="sd">                        If footprint data is in an excel workbook with,</span>
<span class="sd">                        multiple sheets, the sheet name must be passed</span>
<span class="sd">                        to the keyword argumment &#39;sheet&#39;</span>

<span class="sd">                            or</span>

<span class="sd">                        an existing DataFrame with footprint data</span>
<span class="sd">        optional args:</span>
<span class="sd">            clear - bool, True will replace all existing footprints with the</span>
<span class="sd">                    loaded ones, False will simply add loaded footprints to</span>
<span class="sd">                    the list of existing ones.</span>
<span class="sd">        kw:</span>
<span class="sd">            sheet - str, specifies the target sheet if an excel workbook with</span>
<span class="sd">                    multiple sheets is passed in&quot;&quot;&quot;</span>
        <span class="c1">#load file if footprints is not a DataFrame</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">footprints</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">t</span> <span class="ow">is</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">footprints</span>
        <span class="k">elif</span><span class="p">((</span><span class="n">t</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">t</span> <span class="ow">is</span> <span class="nb">unicode</span><span class="p">)):</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">footprints</span><span class="p">):</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="n">footprints</span><span class="p">[</span><span class="n">footprints</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">):</span>
                    <span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">footprints</span><span class="p">,</span> <span class="n">sheetname</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;sheet&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                            <span class="n">df</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;sheet&#39;</span><span class="p">]]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;If an excel file with multiple
                            sheets is passed to Results.load_footprints, the
                            target sheet must be specified with the keyword
                            argument &#39;sheet&#39;.&quot;&quot;&quot;</span><span class="p">))</span><span class="n">
</span>                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">elif</span><span class="p">(</span><span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">):</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">footprints</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;Only csv and xlsx files can be passed to
                    Results.load_footprints.&quot;</span><span class="p">))</span><span class="n">
</span>            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;No extension was detected at the end of file
                name &quot;</span><span class="si">%s</span><span class="s2">&quot; passed to Results.load_footprints. File names passed
                to load_footprints must have .csv or .xlsx extensions.&quot;&quot;&quot;</span> <span class="o">%</span><span class="n">
</span>                <span class="nb">str</span><span class="p">(</span><span class="n">footprints</span><span class="p">)))</span><span class="n">
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Only pandas DataFrames and strings can be passed to
            Results.load_footprints, not type &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span><span class="n">
</span>
        <span class="c1">#do a little data conditioning</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
        <span class="c1">#match columns with string distance method</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">_footprint_cols</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_Levenshtein_group</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
        <span class="c1">#store an error message</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            The column:</span>
<span class="s2">                &quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="s2">            must contain only a single value for each unique footprint.</span>
<span class="s2">            The value should simply be repeated to fill all cells.</span>
<span class="s2">            The column contains multiple values for footprint name:</span>
<span class="s2">                &quot;</span><span class="si">%s</span><span class="s2">&quot; &quot;&quot;&quot;</span>
        <span class="c1">#pick out some columns</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
        <span class="c1">#clear the footprints list</span>
        <span class="k">if</span><span class="p">(</span><span class="n">clear</span><span class="p">):</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">_footprints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#create a footprint out of rows with the same &quot;Name&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="c1">#check that certain fields only contain a single entry</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
            <span class="c1">#create a footprint object</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">Footprint</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">row</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">row</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="n">row</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="n">row</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
            <span class="c1">#append the Footprint to the Results object&#39;s list</span>
            <span class="bp2">self</span><span class="o">.</span><span class="n">_footprints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-path><p class="function-str"><span class="function-name">path</span>(<span class="function-arg">points</span>, <span class="function-arg">n</span>=<span class="function-arg">101</span>, <span class="function-arg">close_path</span>=<span class="function-arg">False</span>)</p><p class="docstr">Interpolate the field along a path defined by lists of x and y<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;coordinates<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;points - an iterable of x,y pairs representing a path through the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; results grid, for example: [(1,2), (1,3), (2,4)]<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;n - integer, approximate total number of points sampled. Each<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;segment will have at least two samples (the beginning and end<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;of the segment). The default is 101.<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;close_path - bool, if True, append a segment to the end of the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp; path connecting the first and last points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - array of x coordinates sampled along the path, will<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;include all input coordinates<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - array of y coordinates sampled along the path, will<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;include all input coordinates<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B_interp - interpolated values corresponding to the input<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;   coordinates</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">close_path</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Interpolate the field along a path defined by lists of x and y</span>
<span class="sd">        coordinates</span>
<span class="sd">        args:</span>
<span class="sd">            points - an iterable of x,y pairs representing a path through the</span>
<span class="sd">                     results grid, for example: [(1,2), (1,3), (2,4)]</span>
<span class="sd">        optional args:</span>
<span class="sd">            n - integer, approximate total number of points sampled. Each</span>
<span class="sd">                segment will have at least two samples (the beginning and end</span>
<span class="sd">                of the segment). The default is 101.</span>
<span class="sd">            close_path - bool, if True, append a segment to the end of the</span>
<span class="sd">                         path connecting the first and last points</span>
<span class="sd">        returns:</span>
<span class="sd">            x - array of x coordinates sampled along the path, will</span>
<span class="sd">                include all input coordinates</span>
<span class="sd">            y - array of y coordinates sampled along the path, will</span>
<span class="sd">                include all input coordinates</span>
<span class="sd">            B_interp - interpolated values corresponding to the input</span>
<span class="sd">                       coordinates&quot;&quot;&quot;</span>
        <span class="c1">#check closing path kw</span>
        <span class="k">if</span><span class="p">(</span><span class="n">close_path</span><span class="p">):</span>
            <span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#get sample points</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">points</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_interp_path_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="c1">#interpolate</span>
        <span class="n">B_interp</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_interp</span><span class="p">))</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-rereference><p class="function-str"><span class="function-name">rereference</span>(<span class="function-arg">x_ref</span>=<span class="function-arg">0</span>, <span class="function-arg">y_ref</span>=<span class="function-arg">0</span>, <span class="function-arg">inplace</span>=<span class="function-arg">False</span>)</p><p class="docstr">Redefine the coordinates of the bottom left corner of the results grid (the lowest values along each axis) and increment values in the spatial grids accordingly. If no value is provided, spatial grids are adjusted start at (0, 0).<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_ref - float, new starting value for the x axis, default is zero<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y_ref - float, new starting value for the y axis, default is zero<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inplace - bool, if True, the Results is rereferenced in place,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  otherwise a rereferenced copy is returned.</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">rereference</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">x_ref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_ref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Redefine the coordinates of the bottom left corner of the results
        grid (the lowest values along each axis) and increment values in the
        spatial grids accordingly. If no value is provided, spatial grids are
        adjusted start at (0, 0).
        optional args:</span>
<span class="sd">            x_ref - float, new starting value for the x axis, default is zero</span>
<span class="sd">            y_ref - float, new starting value for the y axis, default is zero</span>
<span class="sd">            inplace - bool, if True, the Results is rereferenced in place,</span>
<span class="sd">                      otherwise a rereferenced copy is returned.&quot;&quot;&quot;</span>
        <span class="c1">#get variables</span>
        <span class="k">if</span><span class="p">(</span><span class="n">inplace</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp2">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">Y</span>
        <span class="c1">#rereference the grid and child footprint objects</span>
        <span class="n">xdif</span><span class="p">,</span> <span class="n">ydif</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_ref</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_ref</span>
        <span class="n">X</span> <span class="o">-=</span> <span class="n">xdif</span>
        <span class="n">Y</span> <span class="o">-=</span> <span class="n">ydif</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">footprints</span><span class="p">)):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">_footprints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">_footprints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_y</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_footprints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="p">[(</span><span class="n">j</span> <span class="o">-</span> <span class="n">xdif</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_footprints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="p">[(</span><span class="n">j</span> <span class="o">-</span> <span class="n">ydif</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">inplace</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-resample><p class="function-str"><span class="function-name">resample</span>(**<span class="function-arg">kw</span>)</p><p class="docstr">Resample the results grid along a new number of x,y values, a new selection of x,y values, or a new number of total values<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;kw:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - int or iterable, new number of x samples or new<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;selection of x samples<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - int or iterable, new number of y samples or new<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;selection of y samples<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;N - int, new approximate number of total samples<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;- overrides x and y kw<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;- preserves approx ratio of number of x and y values<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;- rounds up to nearest possible whole number of points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inplace - resample in place or return a new object, default is False<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;res_resample - a new Results object containing the resampled grid</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resample the results grid along a new number of x,y values, a new
        selection of x,y values, or a new number of total values
        kw:</span>
<span class="sd">            x - int or iterable, new number of x samples or new</span>
<span class="sd">                selection of x samples</span>
<span class="sd">            y - int or iterable, new number of y samples or new</span>
<span class="sd">                selection of y samples</span>
<span class="sd">            N - int, new approximate number of total samples</span>
<span class="sd">                    - overrides x and y kw</span>
<span class="sd">                    - preserves approx ratio of number of x and y values</span>
<span class="sd">                    - rounds up to nearest possible whole number of points</span>
<span class="sd">            inplace - resample in place or return a new object, default is False</span>
<span class="sd">        returns:</span>
<span class="sd">            res_resample - a new Results object containing the resampled grid&quot;&quot;&quot;</span>

        <span class="c1">#check inputs</span>
        <span class="k">if</span><span class="p">((</span><span class="s1">&#39;x&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;N&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">)):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Keyword arguments x, y, or N are required by Results.resample&#39;</span><span class="p">))</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;inplace&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="n">inplace</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;inplace&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1">#in place or not</span>
        <span class="k">if</span><span class="p">(</span><span class="n">inplace</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp2">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp2">self</span><span class="p">)</span>
        <span class="c1">#store grid x,y extents</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">xmax</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ymax</span>
        <span class="c1">#get 1D vectors of x and y coordinates to resample at, from kw</span>
        <span class="k">if</span><span class="p">(</span><span class="s1">&#39;N&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_is_int</span><span class="p">(</span><span class="n">N</span><span class="p">)):</span>
                <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Keyword argument &quot;N&quot; must be a whole number&#39;</span><span class="p">))</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">aspect</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span>
            <span class="n">N_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">aspect</span><span class="p">))</span>
            <span class="n">N_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">N_y</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">N_x</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">N_y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
                <span class="k">if</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_is_int</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
                <span class="k">if</span><span class="p">(</span><span class="n">subcalc_funks</span><span class="o">.</span><span class="n">_is_int</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">y</span>
        <span class="c1">#flip y coordinates so that Y prints intuitively</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="c1">#resample each grid</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
            <span class="k">if</span><span class="p">((</span><span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;Y&#39;</span><span class="p">)):</span>
                <span class="c1">#some arrays are flipped to conform to _interpn conventions</span>
                <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_interpn</span><span class="p">((</span><span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                                            <span class="p">(</span><span class="n">Y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">X</span><span class="p">))</span>
        <span class="c1">#spatial grids</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span>

        <span class="c1">#return</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">inplace</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-segment><p class="function-str"><span class="function-name">segment</span>(<span class="function-arg">p1</span>, <span class="function-arg">p2</span>, <span class="function-arg">n</span>=<span class="function-arg">101</span>)</p><p class="docstr">Interpolate the magnetic field results along a line between two x,y points<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;p1 - iterable, the fifst x-y pair<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;p2 - iterable, the second pair<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;n - integer, number of points sampled (default 101)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;returns:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x - array, x coordinates of interpolated values<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y - array, y coordinates of interpolated values<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;B_interp - array, interpolated field values</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">segment</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Interpolate the magnetic field results along a line between two x,y points</span>
<span class="sd">        args:</span>
<span class="sd">            p1 - iterable, the fifst x-y pair</span>
<span class="sd">            p2 - iterable, the second pair</span>
<span class="sd">        optional args:</span>
<span class="sd">            n - integer, number of points sampled (default 101)</span>
<span class="sd">        returns:</span>
<span class="sd">            x - array, x coordinates of interpolated values</span>
<span class="sd">            y - array, y coordinates of interpolated values</span>
<span class="sd">            B_interp - array, interpolated field values&quot;&quot;&quot;</span>
        <span class="c1">#check point lengths</span>
        <span class="k">if</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Points must consist of two values (xy pairs).&#39;</span><span class="p">))</span>
        <span class="c1">#create x and y vectors</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">B_interp</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">B_interp</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div><div class="function" id=Results-zoom><p class="function-str"><span class="function-name">zoom</span>(<span class="function-arg">x_range</span>, <span class="function-arg">y_range</span>, <span class="function-arg">inplace</span>=<span class="function-arg">False</span>, <span class="function-arg">rereference</span>=<span class="function-arg">False</span>)</p><p class="docstr">Select a sub-area of the Results grid<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;x_range - iterable of floats, two values representing the range of<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  x values to include in the zoomed grid, if input is<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  implicitly False all values are included (no x zooming)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;y_range - iterable of floats, two values representing the range of<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  y values to include in the zoomed grid, if input is<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  implicitly False all values are included (no y zooming)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;optional args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inplace - bool, if True the Results grid is changed in place,<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  otherwise a new Results is returned with the zoomed grid<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;rereference - bool or number, if a number, the spatial grids will<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  be rereferenced to begin at that value. If True, the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  spatial grids are rereferenced to begin at zero.</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">zoom</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">rereference</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Select a sub-area of the Results grid</span>
<span class="sd">        args:</span>
<span class="sd">            x_range - iterable of floats, two values representing the range of</span>
<span class="sd">                      x values to include in the zoomed grid, if input is</span>
<span class="sd">                      implicitly False all values are included (no x zooming)</span>
<span class="sd">            y_range - iterable of floats, two values representing the range of</span>
<span class="sd">                      y values to include in the zoomed grid, if input is</span>
<span class="sd">                      implicitly False all values are included (no y zooming)</span>
<span class="sd">        optional args:</span>
<span class="sd">            inplace - bool, if True the Results grid is changed in place,</span>
<span class="sd">                      otherwise a new Results is returned with the zoomed grid</span>
<span class="sd">            rereference - bool or number, if a number, the spatial grids will</span>
<span class="sd">                          be rereferenced to begin at that value. If True, the</span>
<span class="sd">                          spatial grids are rereferenced to begin at zero.&quot;&quot;&quot;</span>
        <span class="c1">#check the ranges</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x_range</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">x_range</span> <span class="o">=</span> <span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y_range</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">y_range</span> <span class="o">=</span> <span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
        <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x_range</span><span class="p">),</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">y_range</span><span class="p">)</span>
        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span><span class="p">((</span><span class="ow">not</span> <span class="bp2">self</span><span class="o">.</span><span class="n">in_grid</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp2">self</span><span class="o">.</span><span class="n">in_grid</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">])))):</span>
            <span class="k">raise</span><span class="p">(</span><span class="n">EMFError</span><span class="p">(</span><span class="s1">&#39;Cannot zoom outside the results grid limits. The x
            limits are [</span><span class="si">%g</span><span class="s1">, </span><span class="si">%g</span><span class="s1">] and the y limits are [</span><span class="si">%g</span><span class="s1">, </span><span class="si">%g</span><span class="s1">].&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp2">self</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">
</span>            <span class="bp2">self</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="bp2">self</span><span class="o">.</span><span class="n">ymax</span><span class="p">)))</span><span class="n">
</span>        <span class="c1">#get variables</span>
        <span class="k">if</span><span class="p">(</span><span class="n">inplace</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp2">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp2">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">y</span>
        <span class="c1">#zoom</span>
        <span class="n">bx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_range</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_range</span><span class="p">))</span>
        <span class="n">by</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_range</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_range</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">by</span><span class="p">,:][:,</span><span class="n">bx</span><span class="p">]</span>
        <span class="c1">#check rereferencing</span>
        <span class="k">if</span><span class="p">((</span><span class="nb">type</span><span class="p">(</span><span class="n">rereference</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rereference</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">rereference</span><span class="p">(</span><span class="n">rereference</span><span class="p">,</span> <span class="n">rereference</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">rereference</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">rereference</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">inplace</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

                    </div>
                </div></div></div></div><div class="class" id="Tower"><h3>Tower</h3><p class="docstr">Tower objects are used to define the locations of power lines in a Model.<br><br>&ensp;&ensp;&ensp;&ensp;Towers are connected by their 'group' strings. Towers with the same 'group' are assumed to carry the same wires through a model domain. Thus, because Tower objects in the same group are carrying the same conductors, the order of their 'h', 'v', 'I', and 'phase' properties matters. For example, for a single Tower, all of the 0th elements of those properties correspond to a the same individual wire. For the path of that wire to be accurately calculated, it must also be in the 0th position in Towers of the same group. Towers in the same group must also have the same number of wires, meaning their 'h', 'v', 'I', and 'phase' arrays must have the same lengths.<br><br>&ensp;&ensp;&ensp;&ensp;The sequence of Towers in a group is defined by thier 'seq' property. Current is assumed to flow from the Tower with Tower with the lowest 'seq' value to the Tower with the next lowest 'seq' value, and so on.</p><div class="function" ><p class="function-str"><span class="function-name">Tower</span>(<span class="function-arg">group</span>, <span class="function-arg">seq</span>, <span class="function-arg">tower_x</span>, <span class="function-arg">tower_y</span>, <span class="function-arg">rot</span>, <span class="function-arg">h</span>, <span class="function-arg">v</span>, <span class="function-arg">I</span>, <span class="function-arg">phase</span>)</p><p class="docstr">args:<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;group - str, a string used to group towers together into continuous<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;circuits<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;seq - int, a number describing the position of this tower among<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  other towers in the same group, where current is assumed to<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;  run from the 0th tower to the 1st, 2nd, ...<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tower_x - the x coordinate of the tower/pole in the model grid (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tower_y - the y coordinate of the tower/pole in the model grid (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tower_rot - the rotation angle of the tower in degrees, where<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;zero degrees points along the positive x axis and the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;rotation increases clockwise<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;h - iterable of numbers, the horizontal locations of conductors<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;on the tower (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;v - iterable of numbers, the vertical locations of conductors<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;on the tower (ft)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;I - iterable of numbers, the current amplitudes of conductors<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;on the tower (Amps)<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;phase - iterable of numbers, the phase angles of conductors on the<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;tower (degrees)</p>
                <div class="source">
                    <h4 onclick="toggleSource(this)">show source</h4>
                    <div class="code">
                        <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp2">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">tower_x</span><span class="p">,</span> <span class="n">tower_y</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        args:</span>
<span class="sd">            group - str, a string used to group towers together into continuous</span>
<span class="sd">                    circuits</span>
<span class="sd">            seq - int, a number describing the position of this tower among</span>
<span class="sd">                  other towers in the same group, where current is assumed to</span>
<span class="sd">                  run from the 0th tower to the 1st, 2nd, ...</span>
<span class="sd">            tower_x - the x coordinate of the tower/pole in the model grid (ft)</span>
<span class="sd">            tower_y - the y coordinate of the tower/pole in the model grid (ft)</span>
<span class="sd">            tower_rot - the rotation angle of the tower in degrees, where</span>
<span class="sd">                        zero degrees points along the positive x axis and the</span>
<span class="sd">                        rotation increases clockwise</span>
<span class="sd">            h - iterable of numbers, the horizontal locations of conductors</span>
<span class="sd">                on the tower (ft)</span>
<span class="sd">            v - iterable of numbers, the vertical locations of conductors</span>
<span class="sd">                on the tower (ft)</span>
<span class="sd">            I - iterable of numbers, the current amplitudes of conductors</span>
<span class="sd">                on the tower (Amps)</span>
<span class="sd">            phase - iterable of numbers, the phase angles of conductors on the</span>
<span class="sd">                    tower (degrees)&quot;&quot;&quot;</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_seq</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_tower_x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_tower_y</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_rot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_v</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_I</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp2">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">tower_x</span> <span class="o">=</span> <span class="n">tower_x</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">tower_y</span> <span class="o">=</span> <span class="n">tower_y</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">rot</span> <span class="o">=</span> <span class="n">rot</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>
        <span class="bp2">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="n">phase</span>
</pre></div>

                    </div>
                </div></div><div class="properties" id="Tower-properties"><h4>Properties</h4><div class="property" id="Tower-I"><p class="property-name">I</p><p class="docstr">Current amplitudes of conductors on the tower (Amps)</p></div><div class="property" id="Tower-conductor_x"><p class="property-name">conductor_x</p><p class="docstr">x-axis coordinates of the conductors on the tower in the model domain, calculated from Tower.x, Tower.h, and Tower.rot (ft)</p></div><div class="property" id="Tower-conductor_y"><p class="property-name">conductor_y</p><p class="docstr">y-axis coordinates of the conductors on the tower in the model domain, calculated from Tower.y, Tower.h, and Tower.rot (ft)</p></div><div class="property" id="Tower-conductor_z"><p class="property-name">conductor_z</p><p class="docstr">z-axis coordinates of the conductors on the tower in the model domain, identical to Tower.h (ft)</p></div><div class="property" id="Tower-group"><p class="property-name">group</p><p class="docstr">String used to group towers together into continuous circuits. All Towers in the same circuit have the same group string.</p></div><div class="property" id="Tower-h"><p class="property-name">h</p><p class="docstr">Horizontal locations of conductors on the tower (ft)</p></div><div class="property" id="Tower-phase"><p class="property-name">phase</p><p class="docstr">Phase angles of conductors on the tower (degrees)</p></div><div class="property" id="Tower-rot"><p class="property-name">rot</p><p class="docstr">Tower rotation (degrees), where zero degrees points along the positive x axis and the rotation increases clockwise</p></div><div class="property" id="Tower-rot_rad"><p class="property-name">rot_rad</p><p class="docstr">Tower rotation (radians), where zero degrees points along the positive x axis and the rotation increases clockwise</p></div><div class="property" id="Tower-seq"><p class="property-name">seq</p><p class="docstr">Integer describing the position of this tower among other towers in the same group, where current is assumed to run from the 0th tower to the 1st, 2nd, ...</p></div><div class="property" id="Tower-tower_x"><p class="property-name">tower_x</p><p class="docstr">Tower x coordinate within the model domain (ft)</p></div><div class="property" id="Tower-tower_y"><p class="property-name">tower_y</p><p class="docstr">Tower y coordinate within the model domain (ft)</p></div><div class="property" id="Tower-v"><p class="property-name">v</p><p class="docstr">Vertical locations of conductors on the tower (ft)</p></div></div></div></div>

                <!--others section-->
                <div class="section" id="others"><h2>others</h2>
                <div class="other" id="be_concerned">
                    <span class="other-name">be_concerned</span><br>
                    &ensp;&ensp;&ensp;&ensp;<span class="other-type">type:</span>bool<br>
                    &ensp;&ensp;&ensp;&ensp;<span class="other-value">value:</span><pre>True</pre>
                    
                </div></div>
            </div>

        </body>



    </html>
    